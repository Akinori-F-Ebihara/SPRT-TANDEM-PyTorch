{".class":"MypyFile","_fullname":"utils.training","future_import_flags":[],"is_partial_stub_package":false,"is_stub":false,"names":{".class":"SymbolTable","Any":{".class":"SymbolTableNode","cross_ref":"typing.Any","kind":"Gdef"},"Dict":{".class":"SymbolTableNode","cross_ref":"typing.Dict","kind":"Gdef"},"PyTorchPhaseManager":{".class":"SymbolTableNode","cross_ref":"utils.misc.PyTorchPhaseManager","kind":"Gdef"},"SummaryWriter":{".class":"SymbolTableNode","cross_ref":"torch.utils.tensorboard.writer.SummaryWriter","kind":"Gdef"},"Trial":{".class":"SymbolTableNode","cross_ref":"optuna.trial._trial.Trial","kind":"Gdef"},"Tuple":{".class":"SymbolTableNode","cross_ref":"typing.Tuple","kind":"Gdef"},"__annotations__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"utils.training.__annotations__","name":"__annotations__","type":{".class":"Instance","args":["builtins.str",{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"type_ref":"builtins.dict"}}},"__doc__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"utils.training.__doc__","name":"__doc__","type":"builtins.str"}},"__file__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"utils.training.__file__","name":"__file__","type":"builtins.str"}},"__name__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"utils.training.__name__","name":"__name__","type":"builtins.str"}},"__package__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"utils.training.__package__","name":"__package__","type":"builtins.str"}},"accumulate_performance":{".class":"SymbolTableNode","cross_ref":"utils.performance_metrics.accumulate_performance","kind":"Gdef"},"colored":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_suppressed_import","is_ready","is_inferred"],"fullname":"utils.training.colored","name":"colored","type":{".class":"AnyType","missing_import_name":"utils.training.colored","source_any":null,"type_of_any":3}}},"compute_loss_and_metrics":{".class":"SymbolTableNode","cross_ref":"models.losses.compute_loss_and_metrics","kind":"Gdef"},"convert_torch_to_numpy":{".class":"SymbolTableNode","cross_ref":"utils.misc.convert_torch_to_numpy","kind":"Gdef"},"data":{".class":"SymbolTableNode","cross_ref":"torch.utils.data","kind":"Gdef"},"eval_postprocess":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Decorator","func":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,0,0,0,0],"arg_names":["model","optimizer","best","performance_metrics","last_example_to_plot","config","tb_writer","global_step"],"dataclass_transform_spec":null,"flags":["is_decorated"],"fullname":"utils.training.eval_postprocess","name":"eval_postprocess","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,0,0,0],"arg_names":["model","optimizer","best","performance_metrics","last_example_to_plot","config","tb_writer","global_step"],"arg_types":["torch.nn.modules.module.Module","torch.optim.optimizer.Optimizer",{".class":"Instance","args":["builtins.float"],"type_ref":"builtins.tuple"},{".class":"Instance","args":["builtins.str","builtins.float"],"type_ref":"builtins.dict"},{".class":"TupleType","implicit":false,"items":["builtins.float"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"type_ref":"builtins.tuple"}},{".class":"Instance","args":["builtins.str",{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":2}],"type_ref":"builtins.dict"},"torch.utils.tensorboard.writer.SummaryWriter","builtins.int"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"is_ellipsis_args":false,"name":"eval_postprocess","ret_type":{".class":"Instance","args":["builtins.float"],"type_ref":"builtins.tuple"},"type_guard":null,"unpack_kwargs":false,"variables":[]}},"is_overload":false,"var":{".class":"Var","flags":["is_ready","is_inferred"],"fullname":"utils.training.eval_postprocess","name":"eval_postprocess","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,0,0,0],"arg_names":["model","optimizer","best","performance_metrics","last_example_to_plot","config","tb_writer","global_step"],"arg_types":["torch.nn.modules.module.Module","torch.optim.optimizer.Optimizer",{".class":"Instance","args":["builtins.float"],"type_ref":"builtins.tuple"},{".class":"Instance","args":["builtins.str","builtins.float"],"type_ref":"builtins.dict"},{".class":"TupleType","implicit":false,"items":["builtins.float"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"type_ref":"builtins.tuple"}},{".class":"Instance","args":["builtins.str",{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":2}],"type_ref":"builtins.dict"},"torch.utils.tensorboard.writer.SummaryWriter","builtins.int"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"is_ellipsis_args":false,"name":"eval_postprocess","ret_type":{".class":"Instance","args":["builtins.float"],"type_ref":"builtins.tuple"},"type_guard":null,"unpack_kwargs":false,"variables":[]}}}},"fix_random_seed":{".class":"SymbolTableNode","cross_ref":"utils.misc.fix_random_seed","kind":"Gdef"},"get_tb_writer":{".class":"SymbolTableNode","cross_ref":"utils.logging.get_tb_writer","kind":"Gdef"},"import_model":{".class":"SymbolTableNode","cross_ref":"models.temporal_integrators.import_model","kind":"Gdef"},"initialize_optimizer":{".class":"SymbolTableNode","cross_ref":"models.optimizers.initialize_optimizer","kind":"Gdef"},"iterating_over_dataset":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Decorator","func":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,0,0,0,0,0,0],"arg_names":["trial","model","optimizer","device","data_loaders","tb_writer","config","best","global_step","phase"],"dataclass_transform_spec":null,"flags":["is_decorated"],"fullname":"utils.training.iterating_over_dataset","name":"iterating_over_dataset","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,0,0,0,0,0],"arg_names":["trial","model","optimizer","device","data_loaders","tb_writer","config","best","global_step","phase"],"arg_types":["optuna.trial._trial.Trial","torch.nn.modules.module.Module","torch.optim.optimizer.Optimizer","builtins.str",{".class":"Instance","args":["builtins.str",{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":4}],"type_ref":"torch.utils.data.dataloader.DataLoader"}],"type_ref":"builtins.dict"},"torch.utils.tensorboard.writer.SummaryWriter",{".class":"Instance","args":["builtins.str",{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":2}],"type_ref":"builtins.dict"},{".class":"Instance","args":["builtins.float"],"type_ref":"builtins.tuple"},"builtins.int","builtins.str"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"is_ellipsis_args":false,"name":"iterating_over_dataset","ret_type":{".class":"TupleType","implicit":false,"items":[{".class":"Instance","args":["builtins.str","builtins.float"],"type_ref":"builtins.dict"},"builtins.int",{".class":"TupleType","implicit":false,"items":["builtins.float"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"type_ref":"builtins.tuple"}},{".class":"Instance","args":["builtins.float"],"type_ref":"builtins.tuple"}],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"type_ref":"builtins.tuple"}},"type_guard":null,"unpack_kwargs":false,"variables":[]}},"is_overload":false,"var":{".class":"Var","flags":["is_ready","is_inferred"],"fullname":"utils.training.iterating_over_dataset","name":"iterating_over_dataset","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,0,0,0,0,0],"arg_names":["trial","model","optimizer","device","data_loaders","tb_writer","config","best","global_step","phase"],"arg_types":["optuna.trial._trial.Trial","torch.nn.modules.module.Module","torch.optim.optimizer.Optimizer","builtins.str",{".class":"Instance","args":["builtins.str",{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":4}],"type_ref":"torch.utils.data.dataloader.DataLoader"}],"type_ref":"builtins.dict"},"torch.utils.tensorboard.writer.SummaryWriter",{".class":"Instance","args":["builtins.str",{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":2}],"type_ref":"builtins.dict"},{".class":"Instance","args":["builtins.float"],"type_ref":"builtins.tuple"},"builtins.int","builtins.str"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"is_ellipsis_args":false,"name":"iterating_over_dataset","ret_type":{".class":"TupleType","implicit":false,"items":[{".class":"Instance","args":["builtins.str","builtins.float"],"type_ref":"builtins.dict"},"builtins.int",{".class":"TupleType","implicit":false,"items":["builtins.float"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"type_ref":"builtins.tuple"}},{".class":"Instance","args":["builtins.float"],"type_ref":"builtins.tuple"}],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"type_ref":"builtins.tuple"}},"type_guard":null,"unpack_kwargs":false,"variables":[]}}}},"lmdb_dataloaders":{".class":"SymbolTableNode","cross_ref":"utils.data_processing.lmdb_dataloaders","kind":"Gdef"},"load_pretrained_states":{".class":"SymbolTableNode","cross_ref":"models.temporal_integrators.load_pretrained_states","kind":"Gdef"},"log_training_results":{".class":"SymbolTableNode","cross_ref":"utils.logging.log_training_results","kind":"Gdef"},"logger":{".class":"SymbolTableNode","cross_ref":"loguru.logger","kind":"Gdef"},"move_data_to_device":{".class":"SymbolTableNode","cross_ref":"utils.data_processing.move_data_to_device","kind":"Gdef"},"nn":{".class":"SymbolTableNode","cross_ref":"torch.nn","kind":"Gdef"},"optim":{".class":"SymbolTableNode","cross_ref":"torch.optim","kind":"Gdef"},"pdb":{".class":"SymbolTableNode","cross_ref":"pdb","kind":"Gdef"},"prepare_for_training":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Decorator","func":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0],"arg_names":["config","device"],"dataclass_transform_spec":null,"flags":["is_decorated"],"fullname":"utils.training.prepare_for_training","name":"prepare_for_training","type":{".class":"CallableType","arg_kinds":[0,0],"arg_names":["config","device"],"arg_types":[{".class":"Instance","args":["builtins.str",{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":2}],"type_ref":"builtins.dict"},"builtins.str"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"is_ellipsis_args":false,"name":"prepare_for_training","ret_type":{".class":"TupleType","implicit":false,"items":["torch.nn.modules.module.Module","torch.optim.optimizer.Optimizer",{".class":"Instance","args":["builtins.str",{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":4}],"type_ref":"torch.utils.data.dataloader.DataLoader"}],"type_ref":"builtins.dict"},"torch.utils.tensorboard.writer.SummaryWriter"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"type_ref":"builtins.tuple"}},"type_guard":null,"unpack_kwargs":false,"variables":[]}},"is_overload":false,"var":{".class":"Var","flags":["is_ready","is_inferred"],"fullname":"utils.training.prepare_for_training","name":"prepare_for_training","type":{".class":"CallableType","arg_kinds":[0,0],"arg_names":["config","device"],"arg_types":[{".class":"Instance","args":["builtins.str",{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":2}],"type_ref":"builtins.dict"},"builtins.str"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"is_ellipsis_args":false,"name":"prepare_for_training","ret_type":{".class":"TupleType","implicit":false,"items":["torch.nn.modules.module.Module","torch.optim.optimizer.Optimizer",{".class":"Instance","args":["builtins.str",{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":4}],"type_ref":"torch.utils.data.dataloader.DataLoader"}],"type_ref":"builtins.dict"},"torch.utils.tensorboard.writer.SummaryWriter"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"type_ref":"builtins.tuple"}},"type_guard":null,"unpack_kwargs":false,"variables":[]}}}},"report_to_pruner":{".class":"SymbolTableNode","cross_ref":"utils.hyperparameter_tuning.report_to_pruner","kind":"Gdef"},"run_one_epoch":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,0,0,0,0,0,1],"arg_names":["trial","model","optimizer","device","data_loaders","tb_writer","config","best","global_step","phase"],"dataclass_transform_spec":null,"flags":[],"fullname":"utils.training.run_one_epoch","name":"run_one_epoch","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,0,0,0,0,1],"arg_names":["trial","model","optimizer","device","data_loaders","tb_writer","config","best","global_step","phase"],"arg_types":["optuna.trial._trial.Trial","torch.nn.modules.module.Module","torch.optim.optimizer.Optimizer","builtins.str",{".class":"Instance","args":["builtins.str",{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":4}],"type_ref":"torch.utils.data.dataloader.DataLoader"}],"type_ref":"builtins.dict"},"torch.utils.tensorboard.writer.SummaryWriter",{".class":"Instance","args":["builtins.str",{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":2}],"type_ref":"builtins.dict"},{".class":"Instance","args":["builtins.float"],"type_ref":"builtins.tuple"},"builtins.int","builtins.str"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"is_ellipsis_args":false,"name":"run_one_epoch","ret_type":{".class":"TupleType","implicit":false,"items":[{".class":"Instance","args":["builtins.float"],"type_ref":"builtins.tuple"},"builtins.int"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"type_ref":"builtins.tuple"}},"type_guard":null,"unpack_kwargs":false,"variables":[]}}},"save_config_info":{".class":"SymbolTableNode","cross_ref":"utils.logging.save_config_info","kind":"Gdef"},"save_sdre_imgs":{".class":"SymbolTableNode","cross_ref":"utils.logging.save_sdre_imgs","kind":"Gdef"},"set_cpu_workers":{".class":"SymbolTableNode","cross_ref":"utils.misc.set_cpu_workers","kind":"Gdef"},"torch":{".class":"SymbolTableNode","cross_ref":"torch","kind":"Gdef"},"tqdm":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_suppressed_import","is_ready","is_inferred"],"fullname":"utils.training.tqdm","name":"tqdm","type":{".class":"AnyType","missing_import_name":"utils.training.tqdm","source_any":null,"type_of_any":3}}},"training_setup":{".class":"SymbolTableNode","cross_ref":"utils.performance_metrics.training_setup","kind":"Gdef"},"update_and_save_result":{".class":"SymbolTableNode","cross_ref":"utils.checkpoint.update_and_save_result","kind":"Gdef"}},"path":"/home/afe/Dropbox/GitHub/SPRT-TANDEM-PyTorch/sprt-tandem/utils/training.py"}