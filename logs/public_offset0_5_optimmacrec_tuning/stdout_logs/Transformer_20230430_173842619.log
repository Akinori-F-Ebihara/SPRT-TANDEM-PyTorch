2023-04-30 17:38:42.647 | INFO     | utils.misc:fix_random_seed:405 - Random seed is not fixed.
2023-04-30 17:38:42.687 | INFO     | models.temporal_integrators:summarize:568 - 
:'######::'########::'########::'########::::::::::::::::::::::
'##... ##: ##.... ##: ##.... ##:... ##..:::::::::::::::::::::::
 ##:::..:: ##:::: ##: ##:::: ##:::: ##:::::::::::::::::::::::::
. ######:: ########:: ########::::: ##::::'#######:::::::::::::
:..... ##: ##.....::: ##.. ##:::::: ##::::........:::::::::::::
'##::: ##: ##:::::::: ##::. ##::::: ##:::::::::::::::::::::::::
. ######:: ##:::::::: ##:::. ##:::: ##:::::::::::::::::::::::::
:......:::..:::::::::..:::::..:::::..::::::::::::::::::::::::::
'########::::'###::::'##::: ##:'########::'########:'##::::'##:
... ##..::::'## ##::: ###:: ##: ##.... ##: ##.....:: ###::'###:
::: ##:::::'##:. ##:: ####: ##: ##:::: ##: ##::::::: ####'####:
::: ##::::'##:::. ##: ## ## ##: ##:::: ##: ######::: ## ### ##:
::: ##:::: #########: ##. ####: ##:::: ##: ##...:::: ##. #: ##:
::: ##:::: ##.... ##: ##:. ###: ##:::: ##: ##::::::: ##:.:: ##:
::: ##:::: ##:::: ##: ##::. ##: ########:: ########: ##:::: ##:
:::..:::::..:::::..::..::::..::........:::........::..:::::..::

2023-04-30 17:38:42.688 | INFO     | models.temporal_integrators:summarize:571 - [34mofficial PyTorch implementation.[0m
2023-04-30 17:38:43.096 | INFO     | models.temporal_integrators:summarize:593 - Network summary:
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
TANDEMformer                                  [150, 50, 3, 3]           771
â”œâ”€TransformerEncoder: 1-1                     [6750, 1, 128]            --
â”‚    â””â”€ModuleList: 2-6                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-1      [6750, 1, 128]            83,136
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-2      [6750, 1, 128]            83,136
â”œâ”€Linear: 1-2                                 [6750, 64]                8,256
â”œâ”€Dropout: 1-3                                [6750, 64]                --
â”œâ”€TransformerEncoder: 1-4                     [6750, 2, 128]            (recursive)
â”‚    â””â”€ModuleList: 2-6                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-3      [6750, 2, 128]            (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-4      [6750, 2, 128]            (recursive)
â”œâ”€Linear: 1-5                                 [6750, 64]                (recursive)
â”œâ”€Dropout: 1-6                                [6750, 64]                --
â”œâ”€TransformerEncoder: 1-7                     [6750, 3, 128]            (recursive)
â”‚    â””â”€ModuleList: 2-6                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-5      [6750, 3, 128]            (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-6      [6750, 3, 128]            (recursive)
â”œâ”€Linear: 1-8                                 [6750, 64]                (recursive)
â”œâ”€Dropout: 1-9                                [6750, 64]                --
â”œâ”€TransformerEncoder: 1-10                    [6750, 4, 128]            (recursive)
â”‚    â””â”€ModuleList: 2-6                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-7      [6750, 4, 128]            (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-8      [6750, 4, 128]            (recursive)
â”œâ”€Linear: 1-11                                [6750, 64]                (recursive)
â”œâ”€Dropout: 1-12                               [6750, 64]                --
â”œâ”€TransformerEncoder: 1-13                    [6750, 5, 128]            (recursive)
â”‚    â””â”€ModuleList: 2-6                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-9      [6750, 5, 128]            (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-10     [6750, 5, 128]            (recursive)
â”œâ”€Linear: 1-14                                [6750, 64]                (recursive)
â”œâ”€Dropout: 1-15                               [6750, 64]                --
â”œâ”€TransformerEncoder: 1-16                    [6750, 6, 128]            (recursive)
â”‚    â””â”€ModuleList: 2-6                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-11     [6750, 6, 128]            (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-12     [6750, 6, 128]            (recursive)
â”œâ”€Linear: 1-17                                [6750, 64]                (recursive)
â”œâ”€Dropout: 1-18                               [6750, 64]                --
â”œâ”€LayerNorm: 1-19                             [6750, 64]                128
â”œâ”€Linear: 1-20                                [6750, 3]                 195
â”œâ”€LayerNorm: 1-21                             [6750, 64]                (recursive)
â”œâ”€Linear: 1-22                                [6750, 3]                 (recursive)
â”œâ”€LayerNorm: 1-23                             [6750, 64]                (recursive)
â”œâ”€Linear: 1-24                                [6750, 3]                 (recursive)
â”œâ”€LayerNorm: 1-25                             [6750, 64]                (recursive)
â”œâ”€Linear: 1-26                                [6750, 3]                 (recursive)
â”œâ”€LayerNorm: 1-27                             [6750, 64]                (recursive)
â”œâ”€Linear: 1-28                                [6750, 3]                 (recursive)
â”œâ”€LayerNorm: 1-29                             [6750, 64]                (recursive)
â”œâ”€Linear: 1-30                                [6750, 3]                 (recursive)
===============================================================================================
Total params: 175,622
Trainable params: 175,622
Non-trainable params: 0
Total mult-adds (G): 1.73
===============================================================================================
Input size (MB): 3.84
Forward/backward pass size (MB): 1058.51
Params size (MB): 0.17
Estimated Total Size (MB): 1062.52
===============================================================================================
2023-04-30 17:38:43.100 | INFO     | models.temporal_integrators:summarize:594 - Example input shape: torch.Size([150, 50, 128])
2023-04-30 17:38:43.100 | INFO     | models.temporal_integrators:summarize:595 - Example output shape: torch.Size([150, 50, 3, 3])
2023-04-30 17:38:43.103 | INFO     | models.temporal_integrators:import_model:58 - model moved onto: [33mcuda.[0m
2023-04-30 17:38:43.104 | INFO     | models.optimizers:initialize_optimizer:44 - Optimizer:
RMSprop (
Parameter Group 0
    alpha: 0.99
    centered: False
    differentiable: False
    eps: 1e-08
    foreach: None
    lr: 2.6930376454378712e-05
    maximize: False
    momentum: 0
    weight_decay: 0.0001
)
2023-04-30 17:38:43.105 | INFO     | datasets.data_processing:lmdb_dataloaders:293 - loading data... 
2023-04-30 17:38:43.105 | INFO     | datasets.data_processing:lmdb_dataloaders:295 - If this process takes long, consider setting is_load_onto_memory=False or use LMDBIterableDataset.
2023-04-30 17:38:46.464 | INFO     | __main__:objective:356 - Starting epoch #0.
2023-04-30 17:38:52.221 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:38:52.221 | INFO     | utils.logging:log_training_results:281 - Global Step =      0
2023-04-30 17:38:52.222 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.3748599886894226
2023-04-30 17:38:52.222 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 3.4912140369415283
2023-04-30 17:38:52.223 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.39195317029953003
2023-04-30 17:38:52.223 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.18420 * 0.8 * -0.03957
2023-04-30 17:38:52.224 | INFO     | utils.logging:log_training_results:309 - val LLLR :1.22592 * 0.1 * -0.07170
2023-04-30 17:38:52.224 | INFO     | utils.logging:log_training_results:317 - val weight decay:1991.36218 * 0.0001 * 1.00901
2023-04-30 17:38:53.215 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 17:38:53.764 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:38:53.764 | INFO     | utils.logging:log_training_results:281 - Global Step =      0
2023-04-30 17:38:53.765 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.3712822198867798
2023-04-30 17:38:53.765 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 3.602451801300049
2023-04-30 17:38:53.766 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.36636996269226074
2023-04-30 17:38:53.766 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.17468 * 0.8 * -0.03984
2023-04-30 17:38:53.767 | INFO     | utils.logging:log_training_results:309 - train LLLR :1.69373 * 0.1 * -0.07197
2023-04-30 17:38:53.767 | INFO     | utils.logging:log_training_results:317 - train weight decay:1991.36206 * 0.0001 * 1.00874
2023-04-30 17:40:04.263 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:40:04.266 | INFO     | utils.logging:log_training_results:281 - Global Step =    250
2023-04-30 17:40:04.266 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8378067016601562
2023-04-30 17:40:04.267 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 2.4275684356689453
2023-04-30 17:40:04.267 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9530056715011597
2023-04-30 17:40:04.267 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.91113 * 0.8 * -0.04831
2023-04-30 17:40:04.268 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.46528 * 0.1 * -0.08006
2023-04-30 17:40:04.268 | INFO     | utils.logging:log_training_results:317 - val weight decay:1977.11914 * 0.0001 * 0.99904
2023-04-30 17:40:04.324 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-30 17:40:04.343 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 250.
2023-04-30 17:40:05.188 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 17:40:05.653 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:40:05.654 | INFO     | utils.logging:log_training_results:281 - Global Step =    250
2023-04-30 17:40:05.654 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.626707911491394
2023-04-30 17:40:05.655 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.7808191776275635
2023-04-30 17:40:05.655 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.6562818884849548
2023-04-30 17:40:05.656 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.93450 * 0.8 * -0.04833
2023-04-30 17:40:05.656 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.87349 * 0.1 * -0.08009
2023-04-30 17:40:05.656 | INFO     | utils.logging:log_training_results:317 - train weight decay:1977.11914 * 0.0001 * 0.99901
2023-04-30 17:40:38.293 | INFO     | __main__:objective:356 - Starting epoch #1.
2023-04-30 17:41:06.011 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:41:06.011 | INFO     | utils.logging:log_training_results:281 - Global Step =    500
2023-04-30 17:41:06.012 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8608832955360413
2023-04-30 17:41:06.012 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 2.0156197547912598
2023-04-30 17:41:06.013 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9666963219642639
2023-04-30 17:41:06.013 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.88075 * 0.8 * -0.05400
2023-04-30 17:41:06.014 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.37858 * 0.1 * -0.08536
2023-04-30 17:41:06.014 | INFO     | utils.logging:log_training_results:317 - val weight decay:1965.86560 * 0.0001 * 0.99219
2023-04-30 17:41:06.065 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-30 17:41:06.079 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 500.
2023-04-30 17:41:06.081 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-30 17:41:06.920 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 17:41:07.382 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:41:07.382 | INFO     | utils.logging:log_training_results:281 - Global Step =    500
2023-04-30 17:41:07.383 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.6853916645050049
2023-04-30 17:41:07.383 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.46494197845459
2023-04-30 17:41:07.383 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.6886253952980042
2023-04-30 17:41:07.384 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.91508 * 0.8 * -0.05402
2023-04-30 17:41:07.384 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.84565 * 0.1 * -0.08538
2023-04-30 17:41:07.385 | INFO     | utils.logging:log_training_results:317 - train weight decay:1965.86572 * 0.0001 * 0.99217
2023-04-30 17:42:07.842 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:42:07.843 | INFO     | utils.logging:log_training_results:281 - Global Step =    750
2023-04-30 17:42:07.844 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8635132908821106
2023-04-30 17:42:07.844 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.9197747707366943
2023-04-30 17:42:07.844 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9676180481910706
2023-04-30 17:42:07.845 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.87835 * 0.8 * -0.05977
2023-04-30 17:42:07.845 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.36534 * 0.1 * -0.09091
2023-04-30 17:42:07.846 | INFO     | utils.logging:log_training_results:317 - val weight decay:1954.99377 * 0.0001 * 0.98544
2023-04-30 17:42:07.900 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-30 17:42:07.915 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 750.
2023-04-30 17:42:07.917 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-30 17:42:08.740 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 17:42:09.220 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:42:09.220 | INFO     | utils.logging:log_training_results:281 - Global Step =    750
2023-04-30 17:42:09.221 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.6993539333343506
2023-04-30 17:42:09.221 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.381537437438965
2023-04-30 17:42:09.222 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.7863098382949829
2023-04-30 17:42:09.222 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.89158 * 0.8 * -0.05979
2023-04-30 17:42:09.222 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.70960 * 0.1 * -0.09094
2023-04-30 17:42:09.223 | INFO     | utils.logging:log_training_results:317 - train weight decay:1954.99390 * 0.0001 * 0.98541
2023-04-30 17:42:20.014 | INFO     | __main__:objective:356 - Starting epoch #2.
2023-04-30 17:43:08.625 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:43:08.626 | INFO     | utils.logging:log_training_results:281 - Global Step =   1000
2023-04-30 17:43:08.626 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8639400005340576
2023-04-30 17:43:08.627 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.9083292484283447
2023-04-30 17:43:08.627 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.968532383441925
2023-04-30 17:43:08.628 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.87779 * 0.8 * -0.06564
2023-04-30 17:43:08.628 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.36330 * 0.1 * -0.09666
2023-04-30 17:43:08.629 | INFO     | utils.logging:log_training_results:317 - val weight decay:1944.40466 * 0.0001 * 0.97869
2023-04-30 17:43:08.679 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-30 17:43:08.693 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 1000.
2023-04-30 17:43:08.696 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-30 17:43:09.507 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 17:43:09.960 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:43:09.960 | INFO     | utils.logging:log_training_results:281 - Global Step =   1000
2023-04-30 17:43:09.961 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7639272809028625
2023-04-30 17:43:09.961 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.1967592239379883
2023-04-30 17:43:09.962 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.8710058331489563
2023-04-30 17:43:09.962 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.89902 * 0.8 * -0.06566
2023-04-30 17:43:09.962 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.58820 * 0.1 * -0.09668
2023-04-30 17:43:09.963 | INFO     | utils.logging:log_training_results:317 - train weight decay:1944.40454 * 0.0001 * 0.97866
2023-04-30 17:43:51.919 | INFO     | __main__:objective:356 - Starting epoch #3.
2023-04-30 17:44:08.409 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:44:08.410 | INFO     | utils.logging:log_training_results:281 - Global Step =   1250
2023-04-30 17:44:08.410 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8638867139816284
2023-04-30 17:44:08.411 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.905482292175293
2023-04-30 17:44:08.411 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9676951766014099
2023-04-30 17:44:08.411 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.87753 * 0.8 * -0.07159
2023-04-30 17:44:08.412 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.36331 * 0.1 * -0.10249
2023-04-30 17:44:08.412 | INFO     | utils.logging:log_training_results:317 - val weight decay:1933.91443 * 0.0001 * 0.97194
2023-04-30 17:44:09.264 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 17:44:09.736 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:44:09.736 | INFO     | utils.logging:log_training_results:281 - Global Step =   1250
2023-04-30 17:44:09.737 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7514675855636597
2023-04-30 17:44:09.737 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.1804347038269043
2023-04-30 17:44:09.737 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.8566805124282837
2023-04-30 17:44:09.738 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.89776 * 0.8 * -0.07161
2023-04-30 17:44:09.738 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.57324 * 0.1 * -0.10251
2023-04-30 17:44:09.738 | INFO     | utils.logging:log_training_results:317 - train weight decay:1933.91431 * 0.0001 * 0.97191
2023-04-30 17:45:08.606 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:45:08.607 | INFO     | utils.logging:log_training_results:281 - Global Step =   1500
2023-04-30 17:45:08.607 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8636199831962585
2023-04-30 17:45:08.608 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.91132652759552
2023-04-30 17:45:08.608 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9672650694847107
2023-04-30 17:45:08.608 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.87745 * 0.8 * -0.07760
2023-04-30 17:45:08.609 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.36375 * 0.1 * -0.10832
2023-04-30 17:45:08.609 | INFO     | utils.logging:log_training_results:317 - val weight decay:1923.67078 * 0.0001 * 0.96519
2023-04-30 17:45:09.693 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 17:45:10.147 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:45:10.147 | INFO     | utils.logging:log_training_results:281 - Global Step =   1500
2023-04-30 17:45:10.148 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8185978531837463
2023-04-30 17:45:10.148 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.3657076358795166
2023-04-30 17:45:10.149 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.8612909317016602
2023-04-30 17:45:10.149 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.85168 * 0.8 * -0.07762
2023-04-30 17:45:10.149 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.45335 * 0.1 * -0.10833
2023-04-30 17:45:10.150 | INFO     | utils.logging:log_training_results:317 - train weight decay:1923.67065 * 0.0001 * 0.96516
2023-04-30 17:45:31.502 | INFO     | __main__:objective:356 - Starting epoch #4.
2023-04-30 17:46:09.311 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:46:09.312 | INFO     | utils.logging:log_training_results:281 - Global Step =   1750
2023-04-30 17:46:09.312 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8641965985298157
2023-04-30 17:46:09.312 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.909047245979309
2023-04-30 17:46:09.313 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9677202701568604
2023-04-30 17:46:09.313 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.87713 * 0.8 * -0.08366
2023-04-30 17:46:09.314 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.36307 * 0.1 * -0.11411
2023-04-30 17:46:09.314 | INFO     | utils.logging:log_training_results:317 - val weight decay:1913.55554 * 0.0001 * 0.95844
2023-04-30 17:46:09.365 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-30 17:46:09.379 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 1750.
2023-04-30 17:46:09.381 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-30 17:46:10.203 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 17:46:10.660 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:46:10.661 | INFO     | utils.logging:log_training_results:281 - Global Step =   1750
2023-04-30 17:46:10.661 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7242300510406494
2023-04-30 17:46:10.661 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.2937231063842773
2023-04-30 17:46:10.662 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.8079430460929871
2023-04-30 17:46:10.662 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.88525 * 0.8 * -0.08368
2023-04-30 17:46:10.663 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.64280 * 0.1 * -0.11414
2023-04-30 17:46:10.663 | INFO     | utils.logging:log_training_results:317 - train weight decay:1913.55542 * 0.0001 * 0.95841
2023-04-30 17:47:03.842 | INFO     | __main__:objective:356 - Starting epoch #5.
2023-04-30 17:47:09.567 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:47:09.568 | INFO     | utils.logging:log_training_results:281 - Global Step =   2000
2023-04-30 17:47:09.568 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8634499907493591
2023-04-30 17:47:09.569 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.9168163537979126
2023-04-30 17:47:09.569 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9668686389923096
2023-04-30 17:47:09.570 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.87711 * 0.8 * -0.08977
2023-04-30 17:47:09.570 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.36423 * 0.1 * -0.11997
2023-04-30 17:47:09.571 | INFO     | utils.logging:log_training_results:317 - val weight decay:1903.60632 * 0.0001 * 0.95169
2023-04-30 17:47:10.477 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 17:47:10.945 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:47:10.946 | INFO     | utils.logging:log_training_results:281 - Global Step =   2000
2023-04-30 17:47:10.946 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7807334661483765
2023-04-30 17:47:10.947 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.195843458175659
2023-04-30 17:47:10.947 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9192922711372375
2023-04-30 17:47:10.950 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.88377 * 0.8 * -0.08979
2023-04-30 17:47:10.950 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.54519 * 0.1 * -0.11999
2023-04-30 17:47:10.951 | INFO     | utils.logging:log_training_results:317 - train weight decay:1903.60620 * 0.0001 * 0.95166
2023-04-30 17:48:09.744 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:48:09.745 | INFO     | utils.logging:log_training_results:281 - Global Step =   2250
2023-04-30 17:48:09.746 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8637567162513733
2023-04-30 17:48:09.746 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.920558214187622
2023-04-30 17:48:09.746 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9661142826080322
2023-04-30 17:48:09.747 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.87703 * 0.8 * -0.09591
2023-04-30 17:48:09.747 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.36454 * 0.1 * -0.12570
2023-04-30 17:48:09.748 | INFO     | utils.logging:log_training_results:317 - val weight decay:1893.81018 * 0.0001 * 0.94494
2023-04-30 17:48:10.627 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 17:48:11.086 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:48:11.086 | INFO     | utils.logging:log_training_results:281 - Global Step =   2250
2023-04-30 17:48:11.087 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.808275580406189
2023-04-30 17:48:11.087 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.124338150024414
2023-04-30 17:48:11.087 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9162002205848694
2023-04-30 17:48:11.088 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.89952 * 0.8 * -0.09594
2023-04-30 17:48:11.088 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.48670 * 0.1 * -0.12572
2023-04-30 17:48:11.089 | INFO     | utils.logging:log_training_results:317 - train weight decay:1893.81006 * 0.0001 * 0.94491
2023-04-30 17:48:43.050 | INFO     | __main__:objective:356 - Starting epoch #6.
2023-04-30 17:49:09.444 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:49:09.445 | INFO     | utils.logging:log_training_results:281 - Global Step =   2500
2023-04-30 17:49:09.446 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8636566996574402
2023-04-30 17:49:09.446 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.92337965965271
2023-04-30 17:49:09.446 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9680691957473755
2023-04-30 17:49:09.447 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.87698 * 0.8 * -0.10210
2023-04-30 17:49:09.447 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.36496 * 0.1 * -0.13141
2023-04-30 17:49:09.448 | INFO     | utils.logging:log_training_results:317 - val weight decay:1884.10706 * 0.0001 * 0.93819
2023-04-30 17:49:10.292 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 17:49:10.754 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:49:10.755 | INFO     | utils.logging:log_training_results:281 - Global Step =   2500
2023-04-30 17:49:10.755 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8210612535476685
2023-04-30 17:49:10.756 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.3635940551757812
2023-04-30 17:49:10.756 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.8774044513702393
2023-04-30 17:49:10.756 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.86393 * 0.8 * -0.10212
2023-04-30 17:49:10.757 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.44884 * 0.1 * -0.13143
2023-04-30 17:49:10.757 | INFO     | utils.logging:log_training_results:317 - train weight decay:1884.10693 * 0.0001 * 0.93816
2023-04-30 17:50:08.442 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:50:08.442 | INFO     | utils.logging:log_training_results:281 - Global Step =   2750
2023-04-30 17:50:08.443 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8637399673461914
2023-04-30 17:50:08.443 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.9341763257980347
2023-04-30 17:50:08.444 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9670395851135254
2023-04-30 17:50:08.444 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.87665 * 0.8 * -0.10832
2023-04-30 17:50:08.445 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.36591 * 0.1 * -0.13707
2023-04-30 17:50:08.445 | INFO     | utils.logging:log_training_results:317 - val weight decay:1874.52209 * 0.0001 * 0.93144
2023-04-30 17:50:09.308 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 17:50:09.803 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:50:09.804 | INFO     | utils.logging:log_training_results:281 - Global Step =   2750
2023-04-30 17:50:09.804 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7636851072311401
2023-04-30 17:50:09.804 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.348788022994995
2023-04-30 17:50:09.805 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.8426159024238586
2023-04-30 17:50:09.805 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.86290 * 0.8 * -0.10834
2023-04-30 17:50:09.805 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.54391 * 0.1 * -0.13710
2023-04-30 17:50:09.806 | INFO     | utils.logging:log_training_results:317 - train weight decay:1874.52209 * 0.0001 * 0.93141
2023-04-30 17:50:19.869 | INFO     | __main__:objective:356 - Starting epoch #7.
2023-04-30 17:51:06.783 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:51:06.783 | INFO     | utils.logging:log_training_results:281 - Global Step =   3000
2023-04-30 17:51:06.784 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8639333844184875
2023-04-30 17:51:06.784 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.9303196668624878
2023-04-30 17:51:06.785 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9666711688041687
2023-04-30 17:51:06.785 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.87690 * 0.8 * -0.11455
2023-04-30 17:51:06.785 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.36560 * 0.1 * -0.14230
2023-04-30 17:51:06.786 | INFO     | utils.logging:log_training_results:317 - val weight decay:1865.05591 * 0.0001 * 0.92469
2023-04-30 17:51:07.621 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 17:51:08.073 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:51:08.073 | INFO     | utils.logging:log_training_results:281 - Global Step =   3000
2023-04-30 17:51:08.074 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8085069060325623
2023-04-30 17:51:08.074 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.1434502601623535
2023-04-30 17:51:08.074 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.906161367893219
2023-04-30 17:51:08.075 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.88085 * 0.8 * -0.11458
2023-04-30 17:51:08.075 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.45563 * 0.1 * -0.14231
2023-04-30 17:51:08.076 | INFO     | utils.logging:log_training_results:317 - train weight decay:1865.05591 * 0.0001 * 0.92466
2023-04-30 17:51:49.844 | INFO     | __main__:objective:356 - Starting epoch #8.
2023-04-30 17:52:07.038 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:52:07.038 | INFO     | utils.logging:log_training_results:281 - Global Step =   3250
2023-04-30 17:52:07.039 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8633332848548889
2023-04-30 17:52:07.039 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.9373142719268799
2023-04-30 17:52:07.040 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9671225547790527
2023-04-30 17:52:07.040 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.87678 * 0.8 * -0.12083
2023-04-30 17:52:07.040 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.36656 * 0.1 * -0.14748
2023-04-30 17:52:07.041 | INFO     | utils.logging:log_training_results:317 - val weight decay:1855.69373 * 0.0001 * 0.91794
2023-04-30 17:52:08.093 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 17:52:08.567 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:52:08.568 | INFO     | utils.logging:log_training_results:281 - Global Step =   3250
2023-04-30 17:52:08.568 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7990235686302185
2023-04-30 17:52:08.569 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.262830972671509
2023-04-30 17:52:08.569 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9036393165588379
2023-04-30 17:52:08.570 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.87507 * 0.8 * -0.12085
2023-04-30 17:52:08.570 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.47116 * 0.1 * -0.14749
2023-04-30 17:52:08.571 | INFO     | utils.logging:log_training_results:317 - train weight decay:1855.69360 * 0.0001 * 0.91791
2023-04-30 17:53:09.079 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:53:09.079 | INFO     | utils.logging:log_training_results:281 - Global Step =   3500
2023-04-30 17:53:09.080 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8633466958999634
2023-04-30 17:53:09.080 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.9376716613769531
2023-04-30 17:53:09.081 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9675050377845764
2023-04-30 17:53:09.081 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.87672 * 0.8 * -0.12711
2023-04-30 17:53:09.082 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.36681 * 0.1 * -0.15197
2023-04-30 17:53:09.082 | INFO     | utils.logging:log_training_results:317 - val weight decay:1846.38708 * 0.0001 * 0.91118
2023-04-30 17:53:09.916 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 17:53:10.377 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:53:10.377 | INFO     | utils.logging:log_training_results:281 - Global Step =   3500
2023-04-30 17:53:10.378 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.813287079334259
2023-04-30 17:53:10.378 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.220676898956299
2023-04-30 17:53:10.378 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9259577393531799
2023-04-30 17:53:10.379 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.86714 * 0.8 * -0.12714
2023-04-30 17:53:10.379 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.45537 * 0.1 * -0.15197
2023-04-30 17:53:10.380 | INFO     | utils.logging:log_training_results:317 - train weight decay:1846.38696 * 0.0001 * 0.91116
2023-04-30 17:53:32.206 | INFO     | __main__:objective:356 - Starting epoch #9.
2023-04-30 17:54:10.898 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:54:10.898 | INFO     | utils.logging:log_training_results:281 - Global Step =   3750
2023-04-30 17:54:10.899 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8627733588218689
2023-04-30 17:54:10.899 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.9341154098510742
2023-04-30 17:54:10.900 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9659740328788757
2023-04-30 17:54:10.900 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.87724 * 0.8 * -0.13342
2023-04-30 17:54:10.901 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.36702 * 0.1 * -0.15508
2023-04-30 17:54:10.901 | INFO     | utils.logging:log_training_results:317 - val weight decay:1837.19617 * 0.0001 * 0.90443
2023-04-30 17:54:11.773 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 17:54:12.239 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 17:54:12.240 | INFO     | utils.logging:log_training_results:281 - Global Step =   3750
2023-04-30 17:54:12.240 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7988423109054565
2023-04-30 17:54:12.240 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.208371162414551
2023-04-30 17:54:12.241 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9038366675376892
2023-04-30 17:54:12.241 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.86859 * 0.8 * -0.13344
2023-04-30 17:54:12.242 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.50468 * 0.1 * -0.15510
2023-04-30 17:54:12.242 | INFO     | utils.logging:log_training_results:317 - train weight decay:1837.19604 * 0.0001 * 0.90441
2023-04-30 17:55:06.861 | INFO     | utils.logging:investigate_log:155 - num_warning=0/num_error=0 in the .log file.
2023-04-30 17:55:07.185 | INFO     | optuna.study.study:_log_completed_trial:1020 - Trial 35 finished with value: 0.13580340147018433 and parameters: {'LIST_IS_POSITIONAL_ENCODING': False, 'LIST_MODEL_BACKBONE': 'Transformer', 'LIST_WEIGHT_DECAY': 0.0001, 'LIST_LEARNING_RATE': 2.6930376454378712e-05, 'LIST_LLLR_VERSION': 'LSEL', 'LIST_ACTIVATION_FC': 'B2BsqrtV2', 'LIST_PARAM_MULTIPLET_LOSS': 0.8, 'LIST_PARAM_LLR_LOSS': 0.1, 'LIST_IS_ADAPTIVE_LOSS': True, 'LIST_ORDER_SPRT': 5, 'LIST_OPTIMIZER': 'rmsprop', 'LIST_IS_NORMALIZE': True, 'LIST_NUM_THRESH': 500, 'LIST_SPARSITY': 'logspace', 'LIST_NUM_BLOCKS': 2, 'LIST_NUM_HEADS': 2, 'LIST_DROPOUT': 0.2, 'LIST_FF_DIM': 64, 'LIST_MLP_UNITS': 64}. Best is trial 16 with value: 0.12354999780654907.
2023-04-30 17:55:07.338 | INFO     | utils.hyperparameter_tuning:suggest_parameters:560 - [33mStarting a tuning phase.[0m
2023-04-30 17:55:09.927 | INFO     | utils.hyperparameter_tuning:print:394 - 
+------------------------------------------+
|   Hyperparameteres suggested by Optuna   |
+------------------------+-----------------+
|     Parameter name     | Suggested value |
+------------------------+-----------------+
|     ACTIVATION_FC      |       relu      |
|    ACTIVATION_INPUT    |       tanh      |
|   ACTIVATION_OUTPUT    |     B2Bsqrt     |
|    IS_ADAPTIVE_LOSS    |      False      |
|      IS_NORMALIZE      |      False      |
| IS_POSITIONAL_ENCODING |       True      |
| IS_TRAINABLE_ENCODING  |      False      |
|     LEARNING_RATE      |    4.4702e-05   |
|      LLLR_VERSION      |       LLLR      |
|     MODEL_BACKBONE     |       LSTM      |
|       NUM_THRESH       |       500       |
|       OPTIMIZER        |       adam      |
|       ORDER_SPRT       |        5        |
|     PARAM_LLR_LOSS     |       0.4       |
|  PARAM_MULTIPLET_LOSS  |       1.0       |
|        SPARSITY        |    unirandom    |
|      WEIGHT_DECAY      |      0.0005     |
|       WIDTH_LSTM       |       125       |
+------------------------+-----------------+
2023-04-30 17:55:09.931 | INFO     | utils.misc:create_directories_and_log:291 - [33mA new log directory was created: [0m/home/afe/Dropbox/GitHub/SPRT-TANDEM-PyTorch/logs/public_offset0_5_optimmacrec_tuning/checkpoints/LSTM_20230430_175509928/configs
2023-04-30 17:55:09.932 | INFO     | utils.misc:create_directories_and_log:291 - [33mA new log directory was created: [0m/home/afe/Dropbox/GitHub/SPRT-TANDEM-PyTorch/logs/public_offset0_5_optimmacrec_tuning/TensorBoard_events/LSTM_20230430_175509928
