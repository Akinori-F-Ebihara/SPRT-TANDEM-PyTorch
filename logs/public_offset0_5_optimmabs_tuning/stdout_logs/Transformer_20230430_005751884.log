2023-04-30 00:57:51.907 | INFO     | utils.misc:fix_random_seed:405 - Random seed is not fixed.
2023-04-30 00:57:51.926 | INFO     | models.temporal_integrators:summarize:568 - 
:'######::'########::'########::'########::::::::::::::::::::::
'##... ##: ##.... ##: ##.... ##:... ##..:::::::::::::::::::::::
 ##:::..:: ##:::: ##: ##:::: ##:::: ##:::::::::::::::::::::::::
. ######:: ########:: ########::::: ##::::'#######:::::::::::::
:..... ##: ##.....::: ##.. ##:::::: ##::::........:::::::::::::
'##::: ##: ##:::::::: ##::. ##::::: ##:::::::::::::::::::::::::
. ######:: ##:::::::: ##:::. ##:::: ##:::::::::::::::::::::::::
:......:::..:::::::::..:::::..:::::..::::::::::::::::::::::::::
'########::::'###::::'##::: ##:'########::'########:'##::::'##:
... ##..::::'## ##::: ###:: ##: ##.... ##: ##.....:: ###::'###:
::: ##:::::'##:. ##:: ####: ##: ##:::: ##: ##::::::: ####'####:
::: ##::::'##:::. ##: ## ## ##: ##:::: ##: ######::: ## ### ##:
::: ##:::: #########: ##. ####: ##:::: ##: ##...:::: ##. #: ##:
::: ##:::: ##.... ##: ##:. ###: ##:::: ##: ##::::::: ##:.:: ##:
::: ##:::: ##:::: ##: ##::. ##: ########:: ########: ##:::: ##:
:::..:::::..:::::..::..::::..::........:::........::..:::::..::

2023-04-30 00:57:51.927 | INFO     | models.temporal_integrators:summarize:571 - [34mofficial PyTorch implementation.[0m
2023-04-30 00:57:52.031 | INFO     | models.temporal_integrators:summarize:593 - Network summary:
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
TANDEMformer                                  [150, 50, 3, 3]           771
â”œâ”€TransformerEncoder: 1-1                     [6750, 1, 128]            --
â”‚    â””â”€ModuleList: 2-6                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-1      [6750, 1, 128]            74,912
â”œâ”€Linear: 1-2                                 [6750, 64]                8,256
â”œâ”€Dropout: 1-3                                [6750, 64]                --
â”œâ”€TransformerEncoder: 1-4                     [6750, 2, 128]            (recursive)
â”‚    â””â”€ModuleList: 2-6                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-2      [6750, 2, 128]            (recursive)
â”œâ”€Linear: 1-5                                 [6750, 64]                (recursive)
â”œâ”€Dropout: 1-6                                [6750, 64]                --
â”œâ”€TransformerEncoder: 1-7                     [6750, 3, 128]            (recursive)
â”‚    â””â”€ModuleList: 2-6                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-3      [6750, 3, 128]            (recursive)
â”œâ”€Linear: 1-8                                 [6750, 64]                (recursive)
â”œâ”€Dropout: 1-9                                [6750, 64]                --
â”œâ”€TransformerEncoder: 1-10                    [6750, 4, 128]            (recursive)
â”‚    â””â”€ModuleList: 2-6                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-4      [6750, 4, 128]            (recursive)
â”œâ”€Linear: 1-11                                [6750, 64]                (recursive)
â”œâ”€Dropout: 1-12                               [6750, 64]                --
â”œâ”€TransformerEncoder: 1-13                    [6750, 5, 128]            (recursive)
â”‚    â””â”€ModuleList: 2-6                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-5      [6750, 5, 128]            (recursive)
â”œâ”€Linear: 1-14                                [6750, 64]                (recursive)
â”œâ”€Dropout: 1-15                               [6750, 64]                --
â”œâ”€TransformerEncoder: 1-16                    [6750, 6, 128]            (recursive)
â”‚    â””â”€ModuleList: 2-6                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-6      [6750, 6, 128]            (recursive)
â”œâ”€Linear: 1-17                                [6750, 64]                (recursive)
â”œâ”€Dropout: 1-18                               [6750, 64]                --
â”œâ”€GELU: 1-19                                  [6750, 64]                --
â”œâ”€Linear: 1-20                                [6750, 3]                 195
â”œâ”€GELU: 1-21                                  [6750, 64]                --
â”œâ”€Linear: 1-22                                [6750, 3]                 (recursive)
â”œâ”€GELU: 1-23                                  [6750, 64]                --
â”œâ”€Linear: 1-24                                [6750, 3]                 (recursive)
â”œâ”€GELU: 1-25                                  [6750, 64]                --
â”œâ”€Linear: 1-26                                [6750, 3]                 (recursive)
â”œâ”€GELU: 1-27                                  [6750, 64]                --
â”œâ”€Linear: 1-28                                [6750, 3]                 (recursive)
â”œâ”€GELU: 1-29                                  [6750, 64]                --
â”œâ”€Linear: 1-30                                [6750, 3]                 (recursive)
===============================================================================================
Total params: 84,134
Trainable params: 84,134
Non-trainable params: 0
Total mult-adds (M): 342.27
===============================================================================================
Input size (MB): 3.84
Forward/backward pass size (MB): 21.71
Params size (MB): 0.03
Estimated Total Size (MB): 25.58
===============================================================================================
2023-04-30 00:57:52.032 | INFO     | models.temporal_integrators:summarize:594 - Example input shape: torch.Size([150, 50, 128])
2023-04-30 00:57:52.032 | INFO     | models.temporal_integrators:summarize:595 - Example output shape: torch.Size([150, 50, 3, 3])
2023-04-30 00:57:52.034 | INFO     | models.temporal_integrators:import_model:58 - model moved onto: [33mcuda.[0m
2023-04-30 00:57:52.035 | INFO     | models.optimizers:initialize_optimizer:44 - Optimizer:
AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 6.616944855027582e-05
    maximize: False
    weight_decay: 0.0005
)
2023-04-30 00:57:52.035 | INFO     | datasets.data_processing:lmdb_dataloaders:293 - loading data... 
2023-04-30 00:57:52.036 | INFO     | datasets.data_processing:lmdb_dataloaders:295 - If this process takes long, consider setting is_load_onto_memory=False or use LMDBIterableDataset.
2023-04-30 00:57:54.687 | INFO     | __main__:objective:356 - Starting epoch #0.
2023-04-30 00:57:57.645 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 00:57:57.645 | INFO     | utils.logging:log_training_results:281 - Global Step =      0
2023-04-30 00:57:57.646 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.34336668252944946
2023-04-30 00:57:57.646 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 3.4916911125183105
2023-04-30 00:57:57.646 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.3400820791721344
2023-04-30 00:57:57.647 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.10015 * 0.2 * 0.21772
2023-04-30 00:57:57.647 | INFO     | utils.logging:log_training_results:309 - val LLLR :1.14863 * 0.0 * -0.46734
2023-04-30 00:57:57.648 | INFO     | utils.logging:log_training_results:317 - val weight decay:1359.94946 * 0.0005 * -1.50896
2023-04-30 00:57:58.570 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 00:57:58.934 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 00:57:58.936 | INFO     | utils.logging:log_training_results:281 - Global Step =      0
2023-04-30 00:57:58.937 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.3076631426811218
2023-04-30 00:57:58.937 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 3.42936110496521
2023-04-30 00:57:58.937 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.3202382028102875
2023-04-30 00:57:58.938 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.10314 * 0.2 * 0.21778
2023-04-30 00:57:58.938 | INFO     | utils.logging:log_training_results:309 - train LLLR :1.24250 * 0.0 * -0.46727
2023-04-30 00:57:58.939 | INFO     | utils.logging:log_training_results:317 - train weight decay:1359.94946 * 0.0005 * -1.50889
2023-04-30 00:58:28.961 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 00:58:28.962 | INFO     | utils.logging:log_training_results:281 - Global Step =    250
2023-04-30 00:58:28.962 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8567999601364136
2023-04-30 00:58:28.963 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 2.0741007328033447
2023-04-30 00:58:28.963 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9751618504524231
2023-04-30 00:58:28.964 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.93618 * 0.2 * 0.23233
2023-04-30 00:58:28.964 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.40245 * 0.0 * -0.45066
2023-04-30 00:58:28.964 | INFO     | utils.logging:log_training_results:317 - val weight decay:1317.92407 * 0.0005 * -1.49234
2023-04-30 00:58:29.090 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-30 00:58:29.103 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 250.
2023-04-30 00:58:29.944 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 00:58:30.311 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 00:58:30.311 | INFO     | utils.logging:log_training_results:281 - Global Step =    250
2023-04-30 00:58:30.312 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7970181107521057
2023-04-30 00:58:30.312 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.1641714572906494
2023-04-30 00:58:30.313 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9251916408538818
2023-04-30 00:58:30.313 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.93766 * 0.2 * 0.23237
2023-04-30 00:58:30.314 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.47807 * 0.0 * -0.45060
2023-04-30 00:58:30.314 | INFO     | utils.logging:log_training_results:317 - train weight decay:1317.92395 * 0.0005 * -1.49227
2023-04-30 00:58:46.728 | INFO     | __main__:objective:356 - Starting epoch #1.
2023-04-30 00:59:00.633 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 00:59:00.633 | INFO     | utils.logging:log_training_results:281 - Global Step =    500
2023-04-30 00:59:00.634 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8741000294685364
2023-04-30 00:59:00.634 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.3240504562854767
2023-04-30 00:59:00.635 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9815420508384705
2023-04-30 00:59:00.635 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.85894 * 0.2 * 0.24214
2023-04-30 00:59:00.636 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.29878 * 0.0 * -0.43370
2023-04-30 00:59:00.636 | INFO     | utils.logging:log_training_results:317 - val weight decay:1292.00586 * 0.0005 * -1.47565
2023-04-30 00:59:00.763 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-30 00:59:00.779 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 500.
2023-04-30 00:59:00.781 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-30 00:59:01.804 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 00:59:02.152 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 00:59:02.153 | INFO     | utils.logging:log_training_results:281 - Global Step =    500
2023-04-30 00:59:02.153 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.864264190196991
2023-04-30 00:59:02.154 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.1417620182037354
2023-04-30 00:59:02.154 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9725916981697083
2023-04-30 00:59:02.154 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.84901 * 0.2 * 0.24218
2023-04-30 00:59:02.155 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.33560 * 0.0 * -0.43363
2023-04-30 00:59:02.155 | INFO     | utils.logging:log_training_results:317 - train weight decay:1292.00586 * 0.0005 * -1.47558
2023-04-30 00:59:32.461 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 00:59:32.462 | INFO     | utils.logging:log_training_results:281 - Global Step =    750
2023-04-30 00:59:32.462 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8747633099555969
2023-04-30 00:59:32.463 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.25255286693573
2023-04-30 00:59:32.463 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9826679825782776
2023-04-30 00:59:32.464 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.85780 * 0.2 * 0.25100
2023-04-30 00:59:32.464 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.29692 * 0.0 * -0.41646
2023-04-30 00:59:32.465 | INFO     | utils.logging:log_training_results:317 - val weight decay:1260.74854 * 0.0005 * -1.45887
2023-04-30 00:59:32.595 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-30 00:59:32.610 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 750.
2023-04-30 00:59:32.613 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-30 00:59:33.458 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 00:59:33.812 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 00:59:33.813 | INFO     | utils.logging:log_training_results:281 - Global Step =    750
2023-04-30 00:59:33.813 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8256581425666809
2023-04-30 00:59:33.814 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.0797923803329468
2023-04-30 00:59:33.814 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9563730359077454
2023-04-30 00:59:33.815 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.87959 * 0.2 * 0.25104
2023-04-30 00:59:33.815 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.43792 * 0.0 * -0.41639
2023-04-30 00:59:33.815 | INFO     | utils.logging:log_training_results:317 - train weight decay:1260.74854 * 0.0005 * -1.45880
2023-04-30 00:59:39.246 | INFO     | __main__:objective:356 - Starting epoch #2.
2023-04-30 01:00:04.149 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:00:04.150 | INFO     | utils.logging:log_training_results:281 - Global Step =   1000
2023-04-30 01:00:04.151 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8748666048049927
2023-04-30 01:00:04.151 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.271793395280838
2023-04-30 01:00:04.151 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.983262300491333
2023-04-30 01:00:04.152 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.85745 * 0.2 * 0.25895
2023-04-30 01:00:04.152 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.29680 * 0.0 * -0.39893
2023-04-30 01:00:04.153 | INFO     | utils.logging:log_training_results:317 - val weight decay:1230.97546 * 0.0005 * -1.44202
2023-04-30 01:00:06.686 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 01:00:07.080 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:00:07.080 | INFO     | utils.logging:log_training_results:281 - Global Step =   1000
2023-04-30 01:00:07.081 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8624000549316406
2023-04-30 01:00:07.081 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 0.9888432621955872
2023-04-30 01:00:07.081 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.940453052520752
2023-04-30 01:00:07.082 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.85327 * 0.2 * 0.25898
2023-04-30 01:00:07.082 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.31588 * 0.0 * -0.39886
2023-04-30 01:00:07.083 | INFO     | utils.logging:log_training_results:317 - train weight decay:1230.97546 * 0.0005 * -1.44195
2023-04-30 01:00:29.260 | INFO     | __main__:objective:356 - Starting epoch #3.
2023-04-30 01:00:37.805 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:00:37.806 | INFO     | utils.logging:log_training_results:281 - Global Step =   1250
2023-04-30 01:00:37.806 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.875666618347168
2023-04-30 01:00:37.807 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.24361370503902435
2023-04-30 01:00:37.807 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9824675917625427
2023-04-30 01:00:37.808 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.85680 * 0.2 * 0.26593
2023-04-30 01:00:37.808 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.29502 * 0.0 * -0.38112
2023-04-30 01:00:37.808 | INFO     | utils.logging:log_training_results:317 - val weight decay:1201.65967 * 0.0005 * -1.42510
2023-04-30 01:00:37.937 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-30 01:00:37.960 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 1250.
2023-04-30 01:00:37.962 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-30 01:00:38.799 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 01:00:39.164 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:00:39.165 | INFO     | utils.logging:log_training_results:281 - Global Step =   1250
2023-04-30 01:00:39.165 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8671005964279175
2023-04-30 01:00:39.166 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.1004359722137451
2023-04-30 01:00:39.166 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9966942667961121
2023-04-30 01:00:39.167 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.85864 * 0.2 * 0.26595
2023-04-30 01:00:39.167 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.32456 * 0.0 * -0.38105
2023-04-30 01:00:39.167 | INFO     | utils.logging:log_training_results:317 - train weight decay:1201.65967 * 0.0005 * -1.42503
2023-04-30 01:01:09.910 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:01:09.911 | INFO     | utils.logging:log_training_results:281 - Global Step =   1500
2023-04-30 01:01:09.912 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8757699131965637
2023-04-30 01:01:09.912 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.22710351645946503
2023-04-30 01:01:09.912 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9829102158546448
2023-04-30 01:01:09.913 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.85659 * 0.2 * 0.27189
2023-04-30 01:01:09.913 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.29467 * 0.0 * -0.36303
2023-04-30 01:01:09.914 | INFO     | utils.logging:log_training_results:317 - val weight decay:1172.87341 * 0.0005 * -1.40812
2023-04-30 01:01:10.040 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-30 01:01:10.054 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 1500.
2023-04-30 01:01:10.057 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-30 01:01:10.878 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 01:01:11.235 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:01:11.236 | INFO     | utils.logging:log_training_results:281 - Global Step =   1500
2023-04-30 01:01:11.236 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8485168218612671
2023-04-30 01:01:11.237 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 0.9886143207550049
2023-04-30 01:01:11.237 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9550445079803467
2023-04-30 01:01:11.237 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.86788 * 0.2 * 0.27191
2023-04-30 01:01:11.238 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.38154 * 0.0 * -0.36296
2023-04-30 01:01:11.238 | INFO     | utils.logging:log_training_results:317 - train weight decay:1172.87341 * 0.0005 * -1.40805
2023-04-30 01:01:22.307 | INFO     | __main__:objective:356 - Starting epoch #4.
2023-04-30 01:01:41.882 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:01:41.883 | INFO     | utils.logging:log_training_results:281 - Global Step =   1750
2023-04-30 01:01:41.884 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8758766055107117
2023-04-30 01:01:41.884 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.23495633900165558
2023-04-30 01:01:41.885 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9835047125816345
2023-04-30 01:01:41.885 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.85645 * 0.2 * 0.27698
2023-04-30 01:01:41.886 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.29478 * 0.0 * -0.34467
2023-04-30 01:01:41.887 | INFO     | utils.logging:log_training_results:317 - val weight decay:1144.39673 * 0.0005 * -1.39108
2023-04-30 01:01:43.089 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 01:01:43.448 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:01:43.449 | INFO     | utils.logging:log_training_results:281 - Global Step =   1750
2023-04-30 01:01:43.450 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8555307388305664
2023-04-30 01:01:43.450 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.0115669965744019
2023-04-30 01:01:43.450 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9843125939369202
2023-04-30 01:01:43.451 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.86916 * 0.2 * 0.27700
2023-04-30 01:01:43.451 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.37334 * 0.0 * -0.34460
2023-04-30 01:01:43.451 | INFO     | utils.logging:log_training_results:317 - train weight decay:1144.39661 * 0.0005 * -1.39102
2023-04-30 01:02:11.196 | INFO     | __main__:objective:356 - Starting epoch #5.
2023-04-30 01:02:14.134 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:02:14.135 | INFO     | utils.logging:log_training_results:281 - Global Step =   2000
2023-04-30 01:02:14.135 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8759433031082153
2023-04-30 01:02:14.136 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.2772022783756256
2023-04-30 01:02:14.136 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9831855297088623
2023-04-30 01:02:14.137 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.85629 * 0.2 * 0.28123
2023-04-30 01:02:14.138 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.29530 * 0.0 * -0.32604
2023-04-30 01:02:14.138 | INFO     | utils.logging:log_training_results:317 - val weight decay:1116.01294 * 0.0005 * -1.37399
2023-04-30 01:02:15.409 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 01:02:15.779 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:02:15.780 | INFO     | utils.logging:log_training_results:281 - Global Step =   2000
2023-04-30 01:02:15.780 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.821948766708374
2023-04-30 01:02:15.781 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.0399492979049683
2023-04-30 01:02:15.781 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9583724141120911
2023-04-30 01:02:15.782 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.86840 * 0.2 * 0.28125
2023-04-30 01:02:15.782 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.41838 * 0.0 * -0.32596
2023-04-30 01:02:15.782 | INFO     | utils.logging:log_training_results:317 - train weight decay:1116.01282 * 0.0005 * -1.37393
2023-04-30 01:02:46.669 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:02:46.670 | INFO     | utils.logging:log_training_results:281 - Global Step =   2250
2023-04-30 01:02:46.670 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8759965896606445
2023-04-30 01:02:46.671 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.21142718195915222
2023-04-30 01:02:46.671 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9831860065460205
2023-04-30 01:02:46.671 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.85614 * 0.2 * 0.28463
2023-04-30 01:02:46.672 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.29394 * 0.0 * -0.30712
2023-04-30 01:02:46.672 | INFO     | utils.logging:log_training_results:317 - val weight decay:1087.89246 * 0.0005 * -1.35686
2023-04-30 01:02:46.797 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-30 01:02:46.818 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 2250.
2023-04-30 01:02:46.823 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-30 01:02:47.687 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 01:02:48.054 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:02:48.054 | INFO     | utils.logging:log_training_results:281 - Global Step =   2250
2023-04-30 01:02:48.055 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8648586273193359
2023-04-30 01:02:48.055 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 0.9206963181495667
2023-04-30 01:02:48.056 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9775403738021851
2023-04-30 01:02:48.056 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.84723 * 0.2 * 0.28464
2023-04-30 01:02:48.056 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.35081 * 0.0 * -0.30704
2023-04-30 01:02:48.057 | INFO     | utils.logging:log_training_results:317 - train weight decay:1087.89233 * 0.0005 * -1.35679
2023-04-30 01:03:04.810 | INFO     | __main__:objective:356 - Starting epoch #6.
2023-04-30 01:03:18.972 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:03:18.972 | INFO     | utils.logging:log_training_results:281 - Global Step =   2500
2023-04-30 01:03:18.973 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8762567043304443
2023-04-30 01:03:18.973 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.22295673191547394
2023-04-30 01:03:18.973 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9833148717880249
2023-04-30 01:03:18.974 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.85586 * 0.2 * 0.28732
2023-04-30 01:03:18.974 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.29376 * 0.0 * -0.28790
2023-04-30 01:03:18.975 | INFO     | utils.logging:log_training_results:317 - val weight decay:1059.99438 * 0.0005 * -1.33968
2023-04-30 01:03:19.943 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 01:03:20.295 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:03:20.297 | INFO     | utils.logging:log_training_results:281 - Global Step =   2500
2023-04-30 01:03:20.297 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8686496019363403
2023-04-30 01:03:20.298 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 0.9190599322319031
2023-04-30 01:03:20.298 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9799456000328064
2023-04-30 01:03:20.299 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.85966 * 0.2 * 0.28733
2023-04-30 01:03:20.299 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.33052 * 0.0 * -0.28783
2023-04-30 01:03:20.302 | INFO     | utils.logging:log_training_results:317 - train weight decay:1059.99438 * 0.0005 * -1.33961
2023-04-30 01:03:51.000 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:03:51.000 | INFO     | utils.logging:log_training_results:281 - Global Step =   2750
2023-04-30 01:03:51.001 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8758666515350342
2023-04-30 01:03:51.001 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.22193634510040283
2023-04-30 01:03:51.001 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.982825517654419
2023-04-30 01:03:51.002 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.85584 * 0.2 * 0.28935
2023-04-30 01:03:51.002 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.29431 * 0.0 * -0.26838
2023-04-30 01:03:51.003 | INFO     | utils.logging:log_training_results:317 - val weight decay:1032.26257 * 0.0005 * -1.32246
2023-04-30 01:03:51.999 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 01:03:52.370 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:03:52.370 | INFO     | utils.logging:log_training_results:281 - Global Step =   2750
2023-04-30 01:03:52.371 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8615540862083435
2023-04-30 01:03:52.371 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 0.861804187297821
2023-04-30 01:03:52.371 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.989396333694458
2023-04-30 01:03:52.372 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.84957 * 0.2 * 0.28935
2023-04-30 01:03:52.372 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.30823 * 0.0 * -0.26831
2023-04-30 01:03:52.373 | INFO     | utils.logging:log_training_results:317 - train weight decay:1032.26257 * 0.0005 * -1.32239
2023-04-30 01:03:57.834 | INFO     | __main__:objective:356 - Starting epoch #7.
2023-04-30 01:04:22.879 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:04:22.879 | INFO     | utils.logging:log_training_results:281 - Global Step =   3000
2023-04-30 01:04:22.880 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8760700225830078
2023-04-30 01:04:22.880 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.19055360555648804
2023-04-30 01:04:22.881 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9832329154014587
2023-04-30 01:04:22.881 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.85574 * 0.2 * 0.29075
2023-04-30 01:04:22.881 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.29370 * 0.0 * -0.24854
2023-04-30 01:04:22.882 | INFO     | utils.logging:log_training_results:317 - val weight decay:1004.65784 * 0.0005 * -1.30521
2023-04-30 01:04:23.005 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-30 01:04:23.020 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 3000.
2023-04-30 01:04:23.023 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-30 01:04:23.842 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 01:04:24.212 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:04:24.213 | INFO     | utils.logging:log_training_results:281 - Global Step =   3000
2023-04-30 01:04:24.213 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8789112567901611
2023-04-30 01:04:24.214 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 0.9489079713821411
2023-04-30 01:04:24.215 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9912817478179932
2023-04-30 01:04:24.216 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.85265 * 0.2 * 0.29076
2023-04-30 01:04:24.217 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.28955 * 0.0 * -0.24846
2023-04-30 01:04:24.218 | INFO     | utils.logging:log_training_results:317 - train weight decay:1004.65778 * 0.0005 * -1.30514
2023-04-30 01:04:46.244 | INFO     | __main__:objective:356 - Starting epoch #8.
2023-04-30 01:04:54.728 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:04:54.729 | INFO     | utils.logging:log_training_results:281 - Global Step =   3250
2023-04-30 01:04:54.729 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8760566711425781
2023-04-30 01:04:54.730 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.2100398689508438
2023-04-30 01:04:54.730 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9827355742454529
2023-04-30 01:04:54.730 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.85558 * 0.2 * 0.29182
2023-04-30 01:04:54.731 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.29355 * 0.0 * -0.22833
2023-04-30 01:04:54.731 | INFO     | utils.logging:log_training_results:317 - val weight decay:977.43768 * 0.0005 * -1.28792
2023-04-30 01:04:56.583 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 01:04:56.997 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:04:56.997 | INFO     | utils.logging:log_training_results:281 - Global Step =   3250
2023-04-30 01:04:56.998 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8933756351470947
2023-04-30 01:04:56.998 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 0.9174379706382751
2023-04-30 01:04:56.998 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9773879051208496
2023-04-30 01:04:56.999 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.84797 * 0.2 * 0.29182
2023-04-30 01:04:56.999 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.29896 * 0.0 * -0.22825
2023-04-30 01:04:57.000 | INFO     | utils.logging:log_training_results:317 - train weight decay:977.43768 * 0.0005 * -1.28785
2023-04-30 01:05:27.510 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:05:27.511 | INFO     | utils.logging:log_training_results:281 - Global Step =   3500
2023-04-30 01:05:27.511 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8763532638549805
2023-04-30 01:05:27.511 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.19585831463336945
2023-04-30 01:05:27.512 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9833264350891113
2023-04-30 01:05:27.512 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.85531 * 0.2 * 0.29243
2023-04-30 01:05:27.513 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.29318 * 0.0 * -0.20772
2023-04-30 01:05:27.513 | INFO     | utils.logging:log_training_results:317 - val weight decay:950.27924 * 0.0005 * -1.27061
2023-04-30 01:05:28.477 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 01:05:28.826 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:05:28.827 | INFO     | utils.logging:log_training_results:281 - Global Step =   3500
2023-04-30 01:05:28.827 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8479424715042114
2023-04-30 01:05:28.827 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 0.896010160446167
2023-04-30 01:05:28.828 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9775288105010986
2023-04-30 01:05:28.828 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.84835 * 0.2 * 0.29243
2023-04-30 01:05:28.829 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.36308 * 0.0 * -0.20763
2023-04-30 01:05:28.829 | INFO     | utils.logging:log_training_results:317 - train weight decay:950.27924 * 0.0005 * -1.27054
2023-04-30 01:05:39.841 | INFO     | __main__:objective:356 - Starting epoch #9.
2023-04-30 01:05:59.386 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:05:59.387 | INFO     | utils.logging:log_training_results:281 - Global Step =   3750
2023-04-30 01:05:59.387 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8762933015823364
2023-04-30 01:05:59.388 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.19327057898044586
2023-04-30 01:05:59.388 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9827496409416199
2023-04-30 01:05:59.388 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.85539 * 0.2 * 0.29279
2023-04-30 01:05:59.389 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.29353 * 0.0 * -0.18663
2023-04-30 01:05:59.389 | INFO     | utils.logging:log_training_results:317 - val weight decay:923.54993 * 0.0005 * -1.25326
2023-04-30 01:06:00.535 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-30 01:06:00.896 | INFO     | utils.logging:log_training_results:280 - 
2023-04-30 01:06:00.897 | INFO     | utils.logging:log_training_results:281 - Global Step =   3750
2023-04-30 01:06:00.897 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8936381340026855
2023-04-30 01:06:00.897 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 0.9368433952331543
2023-04-30 01:06:00.898 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.990967869758606
2023-04-30 01:06:00.898 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.82939 * 0.2 * 0.29279
2023-04-30 01:06:00.899 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.26002 * 0.0 * -0.18654
2023-04-30 01:06:00.899 | INFO     | utils.logging:log_training_results:317 - train weight decay:923.54987 * 0.0005 * -1.25319
2023-04-30 01:06:28.835 | INFO     | utils.logging:investigate_log:155 - num_warning=0/num_error=0 in the .log file.
2023-04-30 01:06:29.038 | INFO     | optuna.study.study:_log_completed_trial:1020 - Trial 84 finished with value: 0.19055360555648804 and parameters: {'LIST_IS_POSITIONAL_ENCODING': False, 'LIST_MODEL_BACKBONE': 'Transformer', 'LIST_WEIGHT_DECAY': 0.0005, 'LIST_LEARNING_RATE': 6.616944855027582e-05, 'LIST_LLLR_VERSION': 'LSEL', 'LIST_ACTIVATION_FC': 'gelu', 'LIST_PARAM_MULTIPLET_LOSS': 0.2, 'LIST_PARAM_LLR_LOSS': 0.0, 'LIST_IS_ADAPTIVE_LOSS': True, 'LIST_ORDER_SPRT': 5, 'LIST_OPTIMIZER': 'adam', 'LIST_IS_NORMALIZE': False, 'LIST_NUM_THRESH': 1500, 'LIST_SPARSITY': 'unirandom', 'LIST_NUM_BLOCKS': 1, 'LIST_NUM_HEADS': 4, 'LIST_DROPOUT': 0.2, 'LIST_FF_DIM': 32, 'LIST_MLP_UNITS': 64}. Best is trial 77 with value: 0.14105641841888428.
2023-04-30 01:06:29.057 | INFO     | utils.hyperparameter_tuning:suggest_parameters:560 - [33mStarting a tuning phase.[0m
2023-04-30 01:06:29.556 | INFO     | utils.hyperparameter_tuning:print:394 - 
+------------------------------------------+
|   Hyperparameteres suggested by Optuna   |
+------------------------+-----------------+
|     Parameter name     | Suggested value |
+------------------------+-----------------+
|     ACTIVATION_FC      |       gelu      |
|        DROPOUT         |       0.2       |
|         FF_DIM         |        32       |
|    IS_ADAPTIVE_LOSS    |       True      |
|      IS_NORMALIZE      |      False      |
| IS_POSITIONAL_ENCODING |      False      |
|     LEARNING_RATE      |    0.00012878   |
|      LLLR_VERSION      |       LSEL      |
|       MLP_UNITS        |        64       |
|     MODEL_BACKBONE     |   Transformer   |
|       NUM_BLOCKS       |        1        |
|       NUM_HEADS        |        4        |
|       NUM_THRESH       |       1500      |
|       OPTIMIZER        |       adam      |
|       ORDER_SPRT       |        5        |
|     PARAM_LLR_LOSS     |       0.0       |
|  PARAM_MULTIPLET_LOSS  |       0.3       |
|        SPARSITY        |    unirandom    |
|      WEIGHT_DECAY      |      0.0009     |
+------------------------+-----------------+
2023-04-30 01:06:29.558 | INFO     | utils.misc:create_directories_and_log:291 - [33mA new log directory was created: [0m/home/afe/Dropbox/GitHub/SPRT-TANDEM-PyTorch/logs/public_offset0_5_optimmabs_tuning/checkpoints/Transformer_20230430_010629557/configs
2023-04-30 01:06:29.558 | INFO     | utils.misc:create_directories_and_log:291 - [33mA new log directory was created: [0m/home/afe/Dropbox/GitHub/SPRT-TANDEM-PyTorch/logs/public_offset0_5_optimmabs_tuning/TensorBoard_events/Transformer_20230430_010629557
