2023-04-28 16:45:16.653 | INFO     | utils.misc:fix_random_seed:405 - Random seed is not fixed.
2023-04-28 16:45:16.673 | INFO     | models.temporal_integrators:summarize:568 - 
:'######::'########::'########::'########::::::::::::::::::::::
'##... ##: ##.... ##: ##.... ##:... ##..:::::::::::::::::::::::
 ##:::..:: ##:::: ##: ##:::: ##:::: ##:::::::::::::::::::::::::
. ######:: ########:: ########::::: ##::::'#######:::::::::::::
:..... ##: ##.....::: ##.. ##:::::: ##::::........:::::::::::::
'##::: ##: ##:::::::: ##::. ##::::: ##:::::::::::::::::::::::::
. ######:: ##:::::::: ##:::. ##:::: ##:::::::::::::::::::::::::
:......:::..:::::::::..:::::..:::::..::::::::::::::::::::::::::
'########::::'###::::'##::: ##:'########::'########:'##::::'##:
... ##..::::'## ##::: ###:: ##: ##.... ##: ##.....:: ###::'###:
::: ##:::::'##:. ##:: ####: ##: ##:::: ##: ##::::::: ####'####:
::: ##::::'##:::. ##: ## ## ##: ##:::: ##: ######::: ## ### ##:
::: ##:::: #########: ##. ####: ##:::: ##: ##...:::: ##. #: ##:
::: ##:::: ##.... ##: ##:. ###: ##:::: ##: ##::::::: ##:.:: ##:
::: ##:::: ##:::: ##: ##::. ##: ########:: ########: ##:::: ##:
:::..:::::..:::::..::..::::..::........:::........::..:::::..::

2023-04-28 16:45:16.673 | INFO     | models.temporal_integrators:summarize:571 - [34mofficial PyTorch implementation.[0m
2023-04-28 16:45:16.747 | INFO     | models.temporal_integrators:summarize:593 - Network summary:
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
TANDEMformer                                  [150, 50, 3, 3]           3
â”œâ”€PositionalEncoding: 1-1                     [7200, 1, 128]            --
â”‚    â””â”€Dropout: 2-1                           [1, 7200, 128]            --
â”œâ”€TransformerEncoder: 1-2                     [7200, 1, 128]            --
â”‚    â””â”€ModuleList: 2-6                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-1      [7200, 1, 128]            74,912
â”œâ”€Linear: 1-3                                 [7200, 32]                4,128
â”œâ”€Dropout: 1-4                                [7200, 32]                --
â”œâ”€PositionalEncoding: 1-5                     [7200, 2, 128]            --
â”‚    â””â”€Dropout: 2-3                           [2, 7200, 128]            --
â”œâ”€TransformerEncoder: 1-6                     [7200, 2, 128]            (recursive)
â”‚    â””â”€ModuleList: 2-6                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-2      [7200, 2, 128]            (recursive)
â”œâ”€Linear: 1-7                                 [7200, 32]                (recursive)
â”œâ”€Dropout: 1-8                                [7200, 32]                --
â”œâ”€PositionalEncoding: 1-9                     [7200, 3, 128]            --
â”‚    â””â”€Dropout: 2-5                           [3, 7200, 128]            --
â”œâ”€TransformerEncoder: 1-10                    [7200, 3, 128]            (recursive)
â”‚    â””â”€ModuleList: 2-6                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-3      [7200, 3, 128]            (recursive)
â”œâ”€Linear: 1-11                                [7200, 32]                (recursive)
â”œâ”€Dropout: 1-12                               [7200, 32]                --
â”œâ”€Linear: 1-13                                [7200, 3]                 99
â”œâ”€Linear: 1-14                                [7200, 3]                 (recursive)
â”œâ”€Linear: 1-15                                [7200, 3]                 (recursive)
===============================================================================================
Total params: 79,142
Trainable params: 79,142
Non-trainable params: 0
Total mult-adds (M): 282.77
===============================================================================================
Input size (MB): 3.84
Forward/backward pass size (MB): 149.82
Params size (MB): 0.05
Estimated Total Size (MB): 153.71
===============================================================================================
2023-04-28 16:45:16.748 | INFO     | models.temporal_integrators:summarize:594 - Example input shape: torch.Size([150, 50, 128])
2023-04-28 16:45:16.749 | INFO     | models.temporal_integrators:summarize:595 - Example output shape: torch.Size([150, 50, 3, 3])
2023-04-28 16:45:16.752 | INFO     | models.temporal_integrators:import_model:58 - model moved onto: [33mcuda.[0m
2023-04-28 16:45:16.753 | INFO     | models.optimizers:initialize_optimizer:44 - Optimizer:
RMSprop (
Parameter Group 0
    alpha: 0.99
    centered: False
    differentiable: False
    eps: 1e-08
    foreach: None
    lr: 0.00040065510118695127
    maximize: False
    momentum: 0
    weight_decay: 0.0
)
2023-04-28 16:45:16.753 | INFO     | datasets.data_processing:lmdb_dataloaders:293 - loading data... 
2023-04-28 16:45:16.754 | INFO     | datasets.data_processing:lmdb_dataloaders:295 - If this process takes long, consider setting is_load_onto_memory=False or use LMDBIterableDataset.
2023-04-28 16:45:19.130 | INFO     | __main__:objective:356 - Starting epoch #0.
2023-04-28 16:45:21.587 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:45:21.588 | INFO     | utils.logging:log_training_results:281 - Global Step =      0
2023-04-28 16:45:21.588 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.33442333340644836
2023-04-28 16:45:21.589 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 3.5277934074401855
2023-04-28 16:45:21.589 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.3336021602153778
2023-04-28 16:45:21.590 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.10329 * 0.9 * 0.00583
2023-04-28 16:45:21.590 | INFO     | utils.logging:log_training_results:309 - val LLLR :1.34531 * 0.5 * 1.01987
2023-04-28 16:45:21.590 | INFO     | utils.logging:log_training_results:317 - val weight decay:559.68500 * 0.0 * -0.49682
2023-04-28 16:45:22.532 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:45:22.849 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:45:22.850 | INFO     | utils.logging:log_training_results:281 - Global Step =      0
2023-04-28 16:45:22.850 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.3192210793495178
2023-04-28 16:45:22.851 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 3.720480442047119
2023-04-28 16:45:22.851 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.29914888739585876
2023-04-28 16:45:22.854 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.11178 * 0.9 * 0.00984
2023-04-28 16:45:22.855 | INFO     | utils.logging:log_training_results:309 - train LLLR :1.45895 * 0.5 * 1.01587
2023-04-28 16:45:22.855 | INFO     | utils.logging:log_training_results:317 - train weight decay:559.68494 * 0.0 * -0.49282
2023-04-28 16:45:45.607 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:45:45.607 | INFO     | utils.logging:log_training_results:281 - Global Step =    250
2023-04-28 16:45:45.608 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.630536675453186
2023-04-28 16:45:45.608 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 3.493870496749878
2023-04-28 16:45:45.609 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.6495643258094788
2023-04-28 16:45:45.609 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.96501 * 0.9 * 0.03384
2023-04-28 16:45:45.610 | INFO     | utils.logging:log_training_results:309 - val LLLR :1.53775 * 0.5 * 0.87746
2023-04-28 16:45:45.610 | INFO     | utils.logging:log_training_results:317 - val weight decay:559.80481 * 0.0 * -0.34084
2023-04-28 16:45:45.737 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 16:45:45.747 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 250.
2023-04-28 16:45:46.602 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:45:46.952 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:45:46.953 | INFO     | utils.logging:log_training_results:281 - Global Step =    250
2023-04-28 16:45:46.953 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.6007198095321655
2023-04-28 16:45:46.953 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 3.3002614974975586
2023-04-28 16:45:46.954 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.6236982345581055
2023-04-28 16:45:46.954 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.00652 * 0.9 * 0.03389
2023-04-28 16:45:46.954 | INFO     | utils.logging:log_training_results:309 - train LLLR :1.69429 * 0.5 * 0.87710
2023-04-28 16:45:46.955 | INFO     | utils.logging:log_training_results:317 - train weight decay:559.80481 * 0.0 * -0.34038
2023-04-28 16:45:59.410 | INFO     | __main__:objective:356 - Starting epoch #1.
2023-04-28 16:46:10.025 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:46:10.026 | INFO     | utils.logging:log_training_results:281 - Global Step =    500
2023-04-28 16:46:10.026 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.6997800469398499
2023-04-28 16:46:10.027 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 2.3961167335510254
2023-04-28 16:46:10.027 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.7287330031394958
2023-04-28 16:46:10.028 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.96667 * 0.9 * 0.04881
2023-04-28 16:46:10.028 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.84875 * 0.5 * 0.77750
2023-04-28 16:46:10.029 | INFO     | utils.logging:log_training_results:317 - val weight decay:551.95435 * 0.0 * -0.22616
2023-04-28 16:46:10.161 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 16:46:10.171 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 500.
2023-04-28 16:46:10.173 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-28 16:46:10.955 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:46:11.268 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:46:11.268 | INFO     | utils.logging:log_training_results:281 - Global Step =    500
2023-04-28 16:46:11.268 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.6396094560623169
2023-04-28 16:46:11.269 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.7492473125457764
2023-04-28 16:46:11.269 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.696101725101471
2023-04-28 16:46:11.269 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.00646 * 0.9 * 0.04888
2023-04-28 16:46:11.270 | INFO     | utils.logging:log_training_results:309 - train LLLR :1.20373 * 0.5 * 0.77708
2023-04-28 16:46:11.270 | INFO     | utils.logging:log_training_results:317 - train weight decay:551.95435 * 0.0 * -0.22570
2023-04-28 16:46:33.727 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:46:33.728 | INFO     | utils.logging:log_training_results:281 - Global Step =    750
2023-04-28 16:46:33.728 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.7217533588409424
2023-04-28 16:46:33.729 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 2.2073285579681396
2023-04-28 16:46:33.729 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.7615829110145569
2023-04-28 16:46:33.730 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.96294 * 0.9 * 0.06721
2023-04-28 16:46:33.730 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.78065 * 0.5 * 0.67688
2023-04-28 16:46:33.730 | INFO     | utils.logging:log_training_results:317 - val weight decay:546.04321 * 0.0 * -0.10320
2023-04-28 16:46:33.866 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 16:46:33.876 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 750.
2023-04-28 16:46:33.880 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-28 16:46:34.666 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:46:35.175 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:46:35.176 | INFO     | utils.logging:log_training_results:281 - Global Step =    750
2023-04-28 16:46:35.176 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.6765943765640259
2023-04-28 16:46:35.176 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.398787498474121
2023-04-28 16:46:35.177 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.7726797461509705
2023-04-28 16:46:35.177 | INFO     | utils.logging:log_training_results:301 - train MCE loss:0.99848 * 0.9 * 0.06729
2023-04-28 16:46:35.177 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.97157 * 0.5 * 0.67646
2023-04-28 16:46:35.178 | INFO     | utils.logging:log_training_results:317 - train weight decay:546.04321 * 0.0 * -0.10266
2023-04-28 16:46:39.186 | INFO     | __main__:objective:356 - Starting epoch #2.
2023-04-28 16:46:57.698 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:46:57.698 | INFO     | utils.logging:log_training_results:281 - Global Step =   1000
2023-04-28 16:46:57.699 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8553999662399292
2023-04-28 16:46:57.699 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.9938029646873474
2023-04-28 16:46:57.699 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9673807621002197
2023-04-28 16:46:57.700 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.97497 * 0.9 * 0.09109
2023-04-28 16:46:57.700 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.34196 * 0.5 * 0.57800
2023-04-28 16:46:57.701 | INFO     | utils.logging:log_training_results:317 - val weight decay:541.96075 * 0.0 * 0.00026
2023-04-28 16:46:57.832 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 16:46:57.842 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 1000.
2023-04-28 16:46:57.843 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-28 16:46:58.781 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:46:59.108 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:46:59.108 | INFO     | utils.logging:log_training_results:281 - Global Step =   1000
2023-04-28 16:46:59.109 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7095171213150024
2023-04-28 16:46:59.109 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.2654287815093994
2023-04-28 16:46:59.109 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.7870808243751526
2023-04-28 16:46:59.110 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.00476 * 0.9 * 0.09120
2023-04-28 16:46:59.110 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.82458 * 0.5 * 0.57762
2023-04-28 16:46:59.110 | INFO     | utils.logging:log_training_results:317 - train weight decay:541.96075 * 0.0 * -0.00026
2023-04-28 16:47:15.082 | INFO     | __main__:objective:356 - Starting epoch #3.
2023-04-28 16:47:21.544 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:47:21.545 | INFO     | utils.logging:log_training_results:281 - Global Step =   1250
2023-04-28 16:47:21.545 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8200899958610535
2023-04-28 16:47:21.545 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.2885456085205078
2023-04-28 16:47:21.546 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9133183360099792
2023-04-28 16:47:21.546 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.96432 * 0.9 * 0.12194
2023-04-28 16:47:21.547 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.42940 * 0.5 * 0.49081
2023-04-28 16:47:21.547 | INFO     | utils.logging:log_training_results:317 - val weight decay:538.46869 * 0.0 * 0.00020
2023-04-28 16:47:22.441 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:47:22.791 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:47:22.791 | INFO     | utils.logging:log_training_results:281 - Global Step =   1250
2023-04-28 16:47:22.792 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7034249901771545
2023-04-28 16:47:22.792 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.9966721534729004
2023-04-28 16:47:22.792 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.7980974912643433
2023-04-28 16:47:22.793 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.00467 * 0.9 * 0.12208
2023-04-28 16:47:22.793 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.81677 * 0.5 * 0.49059
2023-04-28 16:47:22.793 | INFO     | utils.logging:log_training_results:317 - train weight decay:538.46863 * 0.0 * -0.00020
2023-04-28 16:47:45.424 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:47:45.425 | INFO     | utils.logging:log_training_results:281 - Global Step =   1500
2023-04-28 16:47:45.425 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8643766641616821
2023-04-28 16:47:45.426 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.9573911428451538
2023-04-28 16:47:45.426 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9725331664085388
2023-04-28 16:47:45.427 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.96893 * 0.9 * 0.16077
2023-04-28 16:47:45.427 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.32541 * 0.5 * 0.43007
2023-04-28 16:47:45.427 | INFO     | utils.logging:log_training_results:317 - val weight decay:537.37476 * 0.0 * 0.00020
2023-04-28 16:47:45.563 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 16:47:45.573 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 1500.
2023-04-28 16:47:45.576 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-28 16:47:46.320 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:47:46.661 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:47:46.662 | INFO     | utils.logging:log_training_results:281 - Global Step =   1500
2023-04-28 16:47:46.662 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7305780053138733
2023-04-28 16:47:46.663 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.9313418865203857
2023-04-28 16:47:46.663 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.8371124863624573
2023-04-28 16:47:46.664 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.00886 * 0.9 * 0.16094
2023-04-28 16:47:46.664 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.70954 * 0.5 * 0.42997
2023-04-28 16:47:46.664 | INFO     | utils.logging:log_training_results:317 - train weight decay:537.37476 * 0.0 * -0.00020
2023-04-28 16:47:55.478 | INFO     | __main__:objective:356 - Starting epoch #4.
2023-04-28 16:48:09.906 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:48:09.907 | INFO     | utils.logging:log_training_results:281 - Global Step =   1750
2023-04-28 16:48:09.907 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8702200055122375
2023-04-28 16:48:09.907 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.9648045301437378
2023-04-28 16:48:09.908 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9817865490913391
2023-04-28 16:48:09.908 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.97686 * 0.9 * 0.20781
2023-04-28 16:48:09.909 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.31306 * 0.5 * 0.40385
2023-04-28 16:48:09.909 | INFO     | utils.logging:log_training_results:317 - val weight decay:538.95233 * 0.0 * 0.00020
2023-04-28 16:48:10.041 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 16:48:10.050 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 1750.
2023-04-28 16:48:10.055 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-28 16:48:10.840 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:48:11.181 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:48:11.181 | INFO     | utils.logging:log_training_results:281 - Global Step =   1750
2023-04-28 16:48:11.182 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7334856986999512
2023-04-28 16:48:11.182 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.8894529342651367
2023-04-28 16:48:11.183 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.886985182762146
2023-04-28 16:48:11.183 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.01935 * 0.9 * 0.20801
2023-04-28 16:48:11.183 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.71847 * 0.5 * 0.40423
2023-04-28 16:48:11.184 | INFO     | utils.logging:log_training_results:317 - train weight decay:538.95233 * 0.0 * -0.00020
2023-04-28 16:48:31.149 | INFO     | __main__:objective:356 - Starting epoch #5.
2023-04-28 16:48:33.637 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:48:33.637 | INFO     | utils.logging:log_training_results:281 - Global Step =   2000
2023-04-28 16:48:33.638 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8702266216278076
2023-04-28 16:48:33.638 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.972735583782196
2023-04-28 16:48:33.638 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9828290939331055
2023-04-28 16:48:33.639 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.98887 * 0.9 * 0.26240
2023-04-28 16:48:33.639 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.31454 * 0.5 * 0.38593
2023-04-28 16:48:33.640 | INFO     | utils.logging:log_training_results:317 - val weight decay:542.40637 * 0.0 * 0.00020
2023-04-28 16:48:33.768 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 16:48:33.778 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 2000.
2023-04-28 16:48:33.781 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-28 16:48:34.802 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:48:35.129 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:48:35.130 | INFO     | utils.logging:log_training_results:281 - Global Step =   2000
2023-04-28 16:48:35.130 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7769204378128052
2023-04-28 16:48:35.131 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.739327311515808
2023-04-28 16:48:35.131 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.930589497089386
2023-04-28 16:48:35.131 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.00734 * 0.9 * 0.26263
2023-04-28 16:48:35.132 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.52181 * 0.5 * 0.38544
2023-04-28 16:48:35.132 | INFO     | utils.logging:log_training_results:317 - train weight decay:542.40637 * 0.0 * -0.00020
2023-04-28 16:48:58.506 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:48:58.506 | INFO     | utils.logging:log_training_results:281 - Global Step =   2250
2023-04-28 16:48:58.507 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.852513313293457
2023-04-28 16:48:58.507 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.1108146905899048
2023-04-28 16:48:58.507 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9596608877182007
2023-04-28 16:48:58.508 | INFO     | utils.logging:log_training_results:301 - val MCE loss:0.99909 * 0.9 * 0.32309
2023-04-28 16:48:58.508 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.35654 * 0.5 * 0.36348
2023-04-28 16:48:58.509 | INFO     | utils.logging:log_training_results:317 - val weight decay:547.69006 * 0.0 * 0.00020
2023-04-28 16:48:59.401 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:48:59.723 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:48:59.724 | INFO     | utils.logging:log_training_results:281 - Global Step =   2250
2023-04-28 16:48:59.724 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7692402601242065
2023-04-28 16:48:59.725 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.7889925241470337
2023-04-28 16:48:59.725 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.8898293375968933
2023-04-28 16:48:59.725 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.02134 * 0.9 * 0.32335
2023-04-28 16:48:59.726 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.54550 * 0.5 * 0.36361
2023-04-28 16:48:59.726 | INFO     | utils.logging:log_training_results:317 - train weight decay:547.69000 * 0.0 * -0.00020
2023-04-28 16:49:12.634 | INFO     | __main__:objective:356 - Starting epoch #6.
2023-04-28 16:49:23.150 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:49:23.151 | INFO     | utils.logging:log_training_results:281 - Global Step =   2500
2023-04-28 16:49:23.151 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8590333461761475
2023-04-28 16:49:23.151 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.8719110488891602
2023-04-28 16:49:23.152 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9715776443481445
2023-04-28 16:49:23.153 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.01006 * 0.9 * 0.38803
2023-04-28 16:49:23.153 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.33701 * 0.5 * 0.34895
2023-04-28 16:49:23.153 | INFO     | utils.logging:log_training_results:317 - val weight decay:552.29877 * 0.0 * 0.00020
2023-04-28 16:49:24.053 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:49:24.371 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:49:24.371 | INFO     | utils.logging:log_training_results:281 - Global Step =   2500
2023-04-28 16:49:24.372 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7886743545532227
2023-04-28 16:49:24.372 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.6368671655654907
2023-04-28 16:49:24.372 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.8997136354446411
2023-04-28 16:49:24.373 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.03046 * 0.9 * 0.38830
2023-04-28 16:49:24.374 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.49047 * 0.5 * 0.34897
2023-04-28 16:49:24.375 | INFO     | utils.logging:log_training_results:317 - train weight decay:552.29871 * 0.0 * -0.00020
2023-04-28 16:49:46.798 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:49:46.799 | INFO     | utils.logging:log_training_results:281 - Global Step =   2750
2023-04-28 16:49:46.799 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8520800471305847
2023-04-28 16:49:46.800 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.9870981574058533
2023-04-28 16:49:46.800 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9675325155258179
2023-04-28 16:49:46.801 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.01560 * 0.9 * 0.45519
2023-04-28 16:49:46.801 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.35242 * 0.5 * 0.34454
2023-04-28 16:49:46.801 | INFO     | utils.logging:log_training_results:317 - val weight decay:554.34912 * 0.0 * 0.00020
2023-04-28 16:49:47.722 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:49:48.026 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:49:48.027 | INFO     | utils.logging:log_training_results:281 - Global Step =   2750
2023-04-28 16:49:48.027 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7967499494552612
2023-04-28 16:49:48.027 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.5848313570022583
2023-04-28 16:49:48.028 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9371598362922668
2023-04-28 16:49:48.028 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.03363 * 0.9 * 0.45546
2023-04-28 16:49:48.029 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.45485 * 0.5 * 0.34436
2023-04-28 16:49:48.029 | INFO     | utils.logging:log_training_results:317 - train weight decay:554.34912 * 0.0 * -0.00020
2023-04-28 16:49:52.149 | INFO     | __main__:objective:356 - Starting epoch #7.
2023-04-28 16:50:11.891 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:50:11.892 | INFO     | utils.logging:log_training_results:281 - Global Step =   3000
2023-04-28 16:50:11.892 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8613600134849548
2023-04-28 16:50:11.893 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.7793833613395691
2023-04-28 16:50:11.893 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9767587780952454
2023-04-28 16:50:11.893 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.01900 * 0.9 * 0.52259
2023-04-28 16:50:11.894 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.33126 * 0.5 * 0.33953
2023-04-28 16:50:11.894 | INFO     | utils.logging:log_training_results:317 - val weight decay:557.09686 * 0.0 * 0.00020
2023-04-28 16:50:12.771 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:50:13.091 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:50:13.091 | INFO     | utils.logging:log_training_results:281 - Global Step =   3000
2023-04-28 16:50:13.092 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7957850694656372
2023-04-28 16:50:13.092 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.5211372375488281
2023-04-28 16:50:13.092 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9364001154899597
2023-04-28 16:50:13.093 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.03278 * 0.9 * 0.52285
2023-04-28 16:50:13.093 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.45309 * 0.5 * 0.33945
2023-04-28 16:50:13.093 | INFO     | utils.logging:log_training_results:317 - train weight decay:557.09686 * 0.0 * -0.00020
2023-04-28 16:50:29.079 | INFO     | __main__:objective:356 - Starting epoch #8.
2023-04-28 16:50:35.557 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:50:35.557 | INFO     | utils.logging:log_training_results:281 - Global Step =   3250
2023-04-28 16:50:35.558 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8626300096511841
2023-04-28 16:50:35.558 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.8206477761268616
2023-04-28 16:50:35.558 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9761222004890442
2023-04-28 16:50:35.559 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.02064 * 0.9 * 0.58717
2023-04-28 16:50:35.559 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.32985 * 0.5 * 0.33723
2023-04-28 16:50:35.560 | INFO     | utils.logging:log_training_results:317 - val weight decay:557.93695 * 0.0 * 0.00020
2023-04-28 16:50:36.433 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:50:36.757 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:50:36.758 | INFO     | utils.logging:log_training_results:281 - Global Step =   3250
2023-04-28 16:50:36.758 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8357200622558594
2023-04-28 16:50:36.758 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.6090848445892334
2023-04-28 16:50:36.759 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9504475593566895
2023-04-28 16:50:36.759 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.03247 * 0.9 * 0.58742
2023-04-28 16:50:36.760 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.39692 * 0.5 * 0.33671
2023-04-28 16:50:36.760 | INFO     | utils.logging:log_training_results:317 - train weight decay:557.93689 * 0.0 * -0.00020
2023-04-28 16:50:59.097 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:50:59.097 | INFO     | utils.logging:log_training_results:281 - Global Step =   3500
2023-04-28 16:50:59.098 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8552699685096741
2023-04-28 16:50:59.098 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.8733429908752441
2023-04-28 16:50:59.098 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9703419208526611
2023-04-28 16:50:59.099 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.02084 * 0.9 * 0.64331
2023-04-28 16:50:59.099 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.34550 * 0.5 * 0.33481
2023-04-28 16:50:59.100 | INFO     | utils.logging:log_training_results:317 - val weight decay:559.66699 * 0.0 * 0.00020
2023-04-28 16:50:59.974 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:51:00.286 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:51:00.287 | INFO     | utils.logging:log_training_results:281 - Global Step =   3500
2023-04-28 16:51:00.287 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8289110660552979
2023-04-28 16:51:00.287 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.5370045900344849
2023-04-28 16:51:00.288 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9571041464805603
2023-04-28 16:51:00.288 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.03533 * 0.9 * 0.64350
2023-04-28 16:51:00.289 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.39205 * 0.5 * 0.33427
2023-04-28 16:51:00.289 | INFO     | utils.logging:log_training_results:317 - train weight decay:559.66699 * 0.0 * -0.00020
2023-04-28 16:51:08.290 | INFO     | __main__:objective:356 - Starting epoch #9.
2023-04-28 16:51:22.814 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:51:22.816 | INFO     | utils.logging:log_training_results:281 - Global Step =   3750
2023-04-28 16:51:22.817 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8605233430862427
2023-04-28 16:51:22.818 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.8873507380485535
2023-04-28 16:51:22.818 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9787471294403076
2023-04-28 16:51:22.819 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.02639 * 0.9 * 0.67749
2023-04-28 16:51:22.819 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.33472 * 0.5 * 0.33524
2023-04-28 16:51:22.820 | INFO     | utils.logging:log_training_results:317 - val weight decay:560.84637 * 0.0 * 0.00020
2023-04-28 16:51:23.887 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:51:24.196 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:51:24.197 | INFO     | utils.logging:log_training_results:281 - Global Step =   3750
2023-04-28 16:51:24.197 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8171785473823547
2023-04-28 16:51:24.198 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.5161919593811035
2023-04-28 16:51:24.198 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9606044292449951
2023-04-28 16:51:24.198 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.03580 * 0.9 * 0.67756
2023-04-28 16:51:24.199 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.40170 * 0.5 * 0.33476
2023-04-28 16:51:24.199 | INFO     | utils.logging:log_training_results:317 - train weight decay:560.84637 * 0.0 * -0.00020
2023-04-28 16:51:44.795 | INFO     | utils.logging:investigate_log:155 - num_warning=0/num_error=0 in the .log file.
2023-04-28 16:51:44.991 | INFO     | optuna.study.study:_log_completed_trial:1020 - Trial 53 finished with value: 0.01717090606689453 and parameters: {'LIST_IS_POSITIONAL_ENCODING': True, 'LIST_IS_TRAINABLE_ENCODING': False, 'LIST_MODEL_BACKBONE': 'Transformer', 'LIST_WEIGHT_DECAY': 0.0, 'LIST_LEARNING_RATE': 0.00040065510118695127, 'LIST_LLLR_VERSION': 'LSEL', 'LIST_ACTIVATION_FC': 'B2BsqrtV2', 'LIST_PARAM_MULTIPLET_LOSS': 0.9, 'LIST_PARAM_LLR_LOSS': 0.5, 'LIST_IS_ADAPTIVE_LOSS': True, 'LIST_ORDER_SPRT': 2, 'LIST_OPTIMIZER': 'rmsprop', 'LIST_IS_NORMALIZE': False, 'LIST_NUM_THRESH': 1500, 'LIST_SPARSITY': 'lograndom', 'LIST_NUM_BLOCKS': 1, 'LIST_NUM_HEADS': 4, 'LIST_DROPOUT': 0.2, 'LIST_FF_DIM': 32, 'LIST_MLP_UNITS': 32}. Best is trial 37 with value: 0.016635537147521973.
2023-04-28 16:51:45.013 | INFO     | utils.hyperparameter_tuning:suggest_parameters:560 - [33mStarting a tuning phase.[0m
2023-04-28 16:51:45.518 | INFO     | utils.hyperparameter_tuning:print:394 - 
+------------------------------------------+
|   Hyperparameteres suggested by Optuna   |
+------------------------+-----------------+
|     Parameter name     | Suggested value |
+------------------------+-----------------+
|     ACTIVATION_FC      |     B2Bsqrt     |
|        DROPOUT         |       0.2       |
|         FF_DIM         |        32       |
|    IS_ADAPTIVE_LOSS    |       True      |
|      IS_NORMALIZE      |      False      |
| IS_POSITIONAL_ENCODING |       True      |
| IS_TRAINABLE_ENCODING  |      False      |
|     LEARNING_RATE      |    0.00042386   |
|      LLLR_VERSION      |       LSEL      |
|       MLP_UNITS        |        32       |
|     MODEL_BACKBONE     |   Transformer   |
|       NUM_BLOCKS       |        1        |
|       NUM_HEADS        |        4        |
|       NUM_THRESH       |       500       |
|       OPTIMIZER        |     rmsprop     |
|       ORDER_SPRT       |        2        |
|     PARAM_LLR_LOSS     |       0.5       |
|  PARAM_MULTIPLET_LOSS  |       0.9       |
|        SPARSITY        |    lograndom    |
|      WEIGHT_DECAY      |       0.0       |
+------------------------+-----------------+
2023-04-28 16:51:45.519 | INFO     | utils.misc:create_directories_and_log:291 - [33mA new log directory was created: [0m/home/afe/Dropbox/GitHub/SPRT-TANDEM-PyTorch/logs/public_offset0_5_optimausat_confmx_tuning/checkpoints/Transformer_20230428_165145518/configs
2023-04-28 16:51:45.520 | INFO     | utils.misc:create_directories_and_log:291 - [33mA new log directory was created: [0m/home/afe/Dropbox/GitHub/SPRT-TANDEM-PyTorch/logs/public_offset0_5_optimausat_confmx_tuning/TensorBoard_events/Transformer_20230428_165145518
