2023-04-28 05:28:45.032 | INFO     | utils.misc:fix_random_seed:405 - Random seed is not fixed.
2023-04-28 05:28:45.062 | INFO     | models.temporal_integrators:summarize:568 - 
:'######::'########::'########::'########::::::::::::::::::::::
'##... ##: ##.... ##: ##.... ##:... ##..:::::::::::::::::::::::
 ##:::..:: ##:::: ##: ##:::: ##:::: ##:::::::::::::::::::::::::
. ######:: ########:: ########::::: ##::::'#######:::::::::::::
:..... ##: ##.....::: ##.. ##:::::: ##::::........:::::::::::::
'##::: ##: ##:::::::: ##::. ##::::: ##:::::::::::::::::::::::::
. ######:: ##:::::::: ##:::. ##:::: ##:::::::::::::::::::::::::
:......:::..:::::::::..:::::..:::::..::::::::::::::::::::::::::
'########::::'###::::'##::: ##:'########::'########:'##::::'##:
... ##..::::'## ##::: ###:: ##: ##.... ##: ##.....:: ###::'###:
::: ##:::::'##:. ##:: ####: ##: ##:::: ##: ##::::::: ####'####:
::: ##::::'##:::. ##: ## ## ##: ##:::: ##: ######::: ## ### ##:
::: ##:::: #########: ##. ####: ##:::: ##: ##...:::: ##. #: ##:
::: ##:::: ##.... ##: ##:. ###: ##:::: ##: ##::::::: ##:.:: ##:
::: ##:::: ##:::: ##: ##::. ##: ########:: ########: ##:::: ##:
:::..:::::..:::::..::..::::..::........:::........::..:::::..::

2023-04-28 05:28:45.063 | INFO     | models.temporal_integrators:summarize:571 - [34mofficial PyTorch implementation.[0m
2023-04-28 05:28:45.135 | INFO     | models.temporal_integrators:summarize:593 - Network summary:
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
TANDEMformer                                  [150, 50, 3, 3]           384
â”œâ”€TransformerEncoder: 1-1                     [7200, 1, 128]            --
â”‚    â””â”€ModuleList: 2-3                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-1      [7200, 1, 128]            74,912
â”œâ”€Linear: 1-2                                 [7200, 64]                8,256
â”œâ”€Dropout: 1-3                                [7200, 64]                --
â”œâ”€TransformerEncoder: 1-4                     [7200, 2, 128]            (recursive)
â”‚    â””â”€ModuleList: 2-3                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-2      [7200, 2, 128]            (recursive)
â”œâ”€Linear: 1-5                                 [7200, 64]                (recursive)
â”œâ”€Dropout: 1-6                                [7200, 64]                --
â”œâ”€TransformerEncoder: 1-7                     [7200, 3, 128]            (recursive)
â”‚    â””â”€ModuleList: 2-3                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-3      [7200, 3, 128]            (recursive)
â”œâ”€Linear: 1-8                                 [7200, 64]                (recursive)
â”œâ”€Dropout: 1-9                                [7200, 64]                --
â”œâ”€GELU: 1-10                                  [7200, 64]                --
â”œâ”€Linear: 1-11                                [7200, 3]                 195
â”œâ”€GELU: 1-12                                  [7200, 64]                --
â”œâ”€Linear: 1-13                                [7200, 3]                 (recursive)
â”œâ”€GELU: 1-14                                  [7200, 64]                --
â”œâ”€Linear: 1-15                                [7200, 3]                 (recursive)
===============================================================================================
Total params: 83,747
Trainable params: 83,747
Non-trainable params: 0
Total mult-adds (M): 182.54
===============================================================================================
Input size (MB): 3.84
Forward/backward pass size (MB): 11.58
Params size (MB): 0.03
Estimated Total Size (MB): 15.45
===============================================================================================
2023-04-28 05:28:45.136 | INFO     | models.temporal_integrators:summarize:594 - Example input shape: torch.Size([150, 50, 128])
2023-04-28 05:28:45.137 | INFO     | models.temporal_integrators:summarize:595 - Example output shape: torch.Size([150, 50, 3, 3])
2023-04-28 05:28:45.139 | INFO     | models.temporal_integrators:import_model:58 - model moved onto: [33mcuda.[0m
2023-04-28 05:28:45.141 | INFO     | models.optimizers:initialize_optimizer:44 - Optimizer:
AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 4.9775009712821886e-05
    maximize: False
    weight_decay: 0.0005
)
2023-04-28 05:28:45.142 | INFO     | datasets.data_processing:lmdb_dataloaders:293 - loading data... 
2023-04-28 05:28:45.143 | INFO     | datasets.data_processing:lmdb_dataloaders:295 - If this process takes long, consider setting is_load_onto_memory=False or use LMDBIterableDataset.
2023-04-28 05:28:47.814 | INFO     | __main__:objective:356 - Starting epoch #0.
2023-04-28 05:28:49.456 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:28:49.457 | INFO     | utils.logging:log_training_results:281 - Global Step =      0
2023-04-28 05:28:49.457 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.3288533389568329
2023-04-28 05:28:49.458 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 3.732438564300537
2023-04-28 05:28:49.458 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.33254125714302063
2023-04-28 05:28:49.459 | INFO     | utils.logging:log_training_results:326 - val MCE loss:1.10722 * 0.5
2023-04-28 05:28:49.459 | INFO     | utils.logging:log_training_results:333 - val LLLR :0.37636 * 0.9
2023-04-28 05:28:49.460 | INFO     | utils.logging:log_training_results:340 - val weight decay:958.13263 * 0.0005
2023-04-28 05:28:50.515 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 05:28:50.832 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:28:50.834 | INFO     | utils.logging:log_training_results:281 - Global Step =      0
2023-04-28 05:28:50.834 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.33433225750923157
2023-04-28 05:28:50.834 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 3.667600393295288
2023-04-28 05:28:50.835 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.33241620659828186
2023-04-28 05:28:50.835 | INFO     | utils.logging:log_training_results:326 - train MCE loss:1.11178 * 0.5
2023-04-28 05:28:50.837 | INFO     | utils.logging:log_training_results:333 - train LLLR :0.37258 * 0.9
2023-04-28 05:28:50.837 | INFO     | utils.logging:log_training_results:340 - train weight decay:958.13263 * 0.0005
2023-04-28 05:29:09.904 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:29:09.905 | INFO     | utils.logging:log_training_results:281 - Global Step =    250
2023-04-28 05:29:09.905 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.717323362827301
2023-04-28 05:29:09.906 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 2.921515941619873
2023-04-28 05:29:09.906 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.8421121835708618
2023-04-28 05:29:09.906 | INFO     | utils.logging:log_training_results:326 - val MCE loss:1.07042 * 0.5
2023-04-28 05:29:09.907 | INFO     | utils.logging:log_training_results:333 - val LLLR :0.31060 * 0.9
2023-04-28 05:29:09.907 | INFO     | utils.logging:log_training_results:340 - val weight decay:917.20428 * 0.0005
2023-04-28 05:29:09.979 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 05:29:09.998 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 250.
2023-04-28 05:29:10.936 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 05:29:11.269 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:29:11.269 | INFO     | utils.logging:log_training_results:281 - Global Step =    250
2023-04-28 05:29:11.270 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.5517171621322632
2023-04-28 05:29:11.270 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 3.0096523761749268
2023-04-28 05:29:11.270 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.6062175631523132
2023-04-28 05:29:11.271 | INFO     | utils.logging:log_training_results:326 - train MCE loss:1.08642 * 0.5
2023-04-28 05:29:11.272 | INFO     | utils.logging:log_training_results:333 - train LLLR :0.32812 * 0.9
2023-04-28 05:29:11.272 | INFO     | utils.logging:log_training_results:340 - train weight decay:917.20428 * 0.0005
2023-04-28 05:29:21.727 | INFO     | __main__:objective:356 - Starting epoch #1.
2023-04-28 05:29:30.335 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:29:30.336 | INFO     | utils.logging:log_training_results:281 - Global Step =    500
2023-04-28 05:29:30.336 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8119399547576904
2023-04-28 05:29:30.336 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.939976692199707
2023-04-28 05:29:30.337 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9373537302017212
2023-04-28 05:29:30.337 | INFO     | utils.logging:log_training_results:326 - val MCE loss:1.03108 * 0.5
2023-04-28 05:29:30.338 | INFO     | utils.logging:log_training_results:333 - val LLLR :0.26900 * 0.9
2023-04-28 05:29:30.338 | INFO     | utils.logging:log_training_results:340 - val weight decay:886.40851 * 0.0005
2023-04-28 05:29:30.412 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 05:29:30.431 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 500.
2023-04-28 05:29:30.434 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-28 05:29:31.348 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 05:29:31.658 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:29:31.658 | INFO     | utils.logging:log_training_results:281 - Global Step =    500
2023-04-28 05:29:31.659 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7213555574417114
2023-04-28 05:29:31.659 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.2382564544677734
2023-04-28 05:29:31.659 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.848183810710907
2023-04-28 05:29:31.660 | INFO     | utils.logging:log_training_results:326 - train MCE loss:1.04714 * 0.5
2023-04-28 05:29:31.660 | INFO     | utils.logging:log_training_results:333 - train LLLR :0.28524 * 0.9
2023-04-28 05:29:31.660 | INFO     | utils.logging:log_training_results:340 - train weight decay:886.40851 * 0.0005
2023-04-28 05:29:50.657 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:29:50.658 | INFO     | utils.logging:log_training_results:281 - Global Step =    750
2023-04-28 05:29:50.658 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8512099981307983
2023-04-28 05:29:50.658 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.9919631481170654
2023-04-28 05:29:50.659 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9654310941696167
2023-04-28 05:29:50.660 | INFO     | utils.logging:log_training_results:326 - val MCE loss:0.99625 * 0.5
2023-04-28 05:29:50.661 | INFO     | utils.logging:log_training_results:333 - val LLLR :0.25128 * 0.9
2023-04-28 05:29:50.661 | INFO     | utils.logging:log_training_results:340 - val weight decay:859.00549 * 0.0005
2023-04-28 05:29:50.732 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 05:29:50.749 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 750.
2023-04-28 05:29:50.753 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-28 05:29:51.698 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 05:29:52.040 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:29:52.041 | INFO     | utils.logging:log_training_results:281 - Global Step =    750
2023-04-28 05:29:52.041 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7788981199264526
2023-04-28 05:29:52.042 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.6940959692001343
2023-04-28 05:29:52.042 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9359471797943115
2023-04-28 05:29:52.043 | INFO     | utils.logging:log_training_results:326 - train MCE loss:1.00987 * 0.5
2023-04-28 05:29:52.043 | INFO     | utils.logging:log_training_results:333 - train LLLR :0.26362 * 0.9
2023-04-28 05:29:52.043 | INFO     | utils.logging:log_training_results:340 - train weight decay:859.00543 * 0.0005
2023-04-28 05:29:55.613 | INFO     | __main__:objective:356 - Starting epoch #2.
2023-04-28 05:30:11.839 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:30:11.840 | INFO     | utils.logging:log_training_results:281 - Global Step =   1000
2023-04-28 05:30:11.841 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8597399592399597
2023-04-28 05:30:11.841 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 0.9595691561698914
2023-04-28 05:30:11.842 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9690840244293213
2023-04-28 05:30:11.842 | INFO     | utils.logging:log_training_results:326 - val MCE loss:0.97573 * 0.5
2023-04-28 05:30:11.843 | INFO     | utils.logging:log_training_results:333 - val LLLR :0.24557 * 0.9
2023-04-28 05:30:11.843 | INFO     | utils.logging:log_training_results:340 - val weight decay:832.98224 * 0.0005
2023-04-28 05:30:11.921 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 05:30:11.943 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 1000.
2023-04-28 05:30:11.949 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-28 05:30:12.961 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 05:30:13.318 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:30:13.319 | INFO     | utils.logging:log_training_results:281 - Global Step =   1000
2023-04-28 05:30:13.319 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8257535099983215
2023-04-28 05:30:13.320 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.5876414775848389
2023-04-28 05:30:13.320 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9513170719146729
2023-04-28 05:30:13.321 | INFO     | utils.logging:log_training_results:326 - train MCE loss:0.99369 * 0.5
2023-04-28 05:30:13.322 | INFO     | utils.logging:log_training_results:333 - train LLLR :0.25178 * 0.9
2023-04-28 05:30:13.323 | INFO     | utils.logging:log_training_results:340 - train weight decay:832.98218 * 0.0005
2023-04-28 05:30:27.258 | INFO     | __main__:objective:356 - Starting epoch #3.
2023-04-28 05:30:32.472 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:30:32.474 | INFO     | utils.logging:log_training_results:281 - Global Step =   1250
2023-04-28 05:30:32.474 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8624833226203918
2023-04-28 05:30:32.475 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.3428270816802979
2023-04-28 05:30:32.475 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9722039699554443
2023-04-28 05:30:32.476 | INFO     | utils.logging:log_training_results:326 - val MCE loss:0.96851 * 0.5
2023-04-28 05:30:32.476 | INFO     | utils.logging:log_training_results:333 - val LLLR :0.24385 * 0.9
2023-04-28 05:30:32.477 | INFO     | utils.logging:log_training_results:340 - val weight decay:807.51965 * 0.0005
2023-04-28 05:30:32.545 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 05:30:32.565 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 1250.
2023-04-28 05:30:32.569 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-28 05:30:33.577 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 05:30:33.934 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:30:33.935 | INFO     | utils.logging:log_training_results:281 - Global Step =   1250
2023-04-28 05:30:33.935 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8155433535575867
2023-04-28 05:30:33.935 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.832918643951416
2023-04-28 05:30:33.936 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9313287734985352
2023-04-28 05:30:33.936 | INFO     | utils.logging:log_training_results:326 - train MCE loss:0.98734 * 0.5
2023-04-28 05:30:33.936 | INFO     | utils.logging:log_training_results:333 - train LLLR :0.25329 * 0.9
2023-04-28 05:30:33.937 | INFO     | utils.logging:log_training_results:340 - train weight decay:807.51959 * 0.0005
2023-04-28 05:30:52.933 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:30:52.933 | INFO     | utils.logging:log_training_results:281 - Global Step =   1500
2023-04-28 05:30:52.934 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8614866733551025
2023-04-28 05:30:52.934 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.6487902402877808
2023-04-28 05:30:52.935 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9679535031318665
2023-04-28 05:30:52.935 | INFO     | utils.logging:log_training_results:326 - val MCE loss:0.96260 * 0.5
2023-04-28 05:30:52.935 | INFO     | utils.logging:log_training_results:333 - val LLLR :0.24341 * 0.9
2023-04-28 05:30:52.936 | INFO     | utils.logging:log_training_results:340 - val weight decay:782.80682 * 0.0005
2023-04-28 05:30:54.392 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 05:30:54.737 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:30:54.738 | INFO     | utils.logging:log_training_results:281 - Global Step =   1500
2023-04-28 05:30:54.738 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8135948181152344
2023-04-28 05:30:54.739 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.9857860803604126
2023-04-28 05:30:54.739 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9367564916610718
2023-04-28 05:30:54.743 | INFO     | utils.logging:log_training_results:326 - train MCE loss:0.98510 * 0.5
2023-04-28 05:30:54.744 | INFO     | utils.logging:log_training_results:333 - train LLLR :0.25303 * 0.9
2023-04-28 05:30:54.744 | INFO     | utils.logging:log_training_results:340 - train weight decay:782.80682 * 0.0005
2023-04-28 05:31:01.781 | INFO     | __main__:objective:356 - Starting epoch #4.
2023-04-28 05:31:13.796 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:31:13.797 | INFO     | utils.logging:log_training_results:281 - Global Step =   1750
2023-04-28 05:31:13.797 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8652666807174683
2023-04-28 05:31:13.797 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.6159656047821045
2023-04-28 05:31:13.798 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9729759693145752
2023-04-28 05:31:13.800 | INFO     | utils.logging:log_training_results:326 - val MCE loss:0.96052 * 0.5
2023-04-28 05:31:13.801 | INFO     | utils.logging:log_training_results:333 - val LLLR :0.24241 * 0.9
2023-04-28 05:31:13.802 | INFO     | utils.logging:log_training_results:340 - val weight decay:758.93420 * 0.0005
2023-04-28 05:31:13.879 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 05:31:13.899 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 1750.
2023-04-28 05:31:13.902 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-28 05:31:14.879 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 05:31:15.234 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:31:15.235 | INFO     | utils.logging:log_training_results:281 - Global Step =   1750
2023-04-28 05:31:15.235 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8319781422615051
2023-04-28 05:31:15.235 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.9756518602371216
2023-04-28 05:31:15.236 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9568139910697937
2023-04-28 05:31:15.236 | INFO     | utils.logging:log_training_results:326 - train MCE loss:0.99144 * 0.5
2023-04-28 05:31:15.237 | INFO     | utils.logging:log_training_results:333 - train LLLR :0.25031 * 0.9
2023-04-28 05:31:15.237 | INFO     | utils.logging:log_training_results:340 - train weight decay:758.93414 * 0.0005
2023-04-28 05:31:32.648 | INFO     | __main__:objective:356 - Starting epoch #5.
2023-04-28 05:31:34.393 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:31:34.394 | INFO     | utils.logging:log_training_results:281 - Global Step =   2000
2023-04-28 05:31:34.395 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8652433753013611
2023-04-28 05:31:34.395 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.5933579206466675
2023-04-28 05:31:34.396 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9724103212356567
2023-04-28 05:31:34.396 | INFO     | utils.logging:log_training_results:326 - val MCE loss:0.95943 * 0.5
2023-04-28 05:31:34.397 | INFO     | utils.logging:log_training_results:333 - val LLLR :0.24229 * 0.9
2023-04-28 05:31:34.397 | INFO     | utils.logging:log_training_results:340 - val weight decay:735.79169 * 0.0005
2023-04-28 05:31:36.538 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 05:31:36.889 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:31:36.890 | INFO     | utils.logging:log_training_results:281 - Global Step =   2000
2023-04-28 05:31:36.890 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8370068073272705
2023-04-28 05:31:36.890 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.8007351160049438
2023-04-28 05:31:36.891 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9537393450737
2023-04-28 05:31:36.891 | INFO     | utils.logging:log_training_results:326 - train MCE loss:0.97459 * 0.5
2023-04-28 05:31:36.892 | INFO     | utils.logging:log_training_results:333 - train LLLR :0.24951 * 0.9
2023-04-28 05:31:36.892 | INFO     | utils.logging:log_training_results:340 - train weight decay:735.79163 * 0.0005
2023-04-28 05:31:56.226 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:31:56.227 | INFO     | utils.logging:log_training_results:281 - Global Step =   2250
2023-04-28 05:31:56.228 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.866379976272583
2023-04-28 05:31:56.228 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.6326103210449219
2023-04-28 05:31:56.229 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9725059270858765
2023-04-28 05:31:56.229 | INFO     | utils.logging:log_training_results:326 - val MCE loss:0.95827 * 0.5
2023-04-28 05:31:56.230 | INFO     | utils.logging:log_training_results:333 - val LLLR :0.24206 * 0.9
2023-04-28 05:31:56.230 | INFO     | utils.logging:log_training_results:340 - val weight decay:713.47919 * 0.0005
2023-04-28 05:31:57.270 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 05:31:57.629 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:31:57.630 | INFO     | utils.logging:log_training_results:281 - Global Step =   2250
2023-04-28 05:31:57.630 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8227393627166748
2023-04-28 05:31:57.630 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.853128433227539
2023-04-28 05:31:57.631 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9561197757720947
2023-04-28 05:31:57.632 | INFO     | utils.logging:log_training_results:326 - train MCE loss:0.97687 * 0.5
2023-04-28 05:31:57.632 | INFO     | utils.logging:log_training_results:333 - train LLLR :0.25242 * 0.9
2023-04-28 05:31:57.633 | INFO     | utils.logging:log_training_results:340 - train weight decay:713.47919 * 0.0005
2023-04-28 05:32:08.239 | INFO     | __main__:objective:356 - Starting epoch #6.
2023-04-28 05:32:16.936 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:32:16.937 | INFO     | utils.logging:log_training_results:281 - Global Step =   2500
2023-04-28 05:32:16.937 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.86722332239151
2023-04-28 05:32:16.938 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.605534315109253
2023-04-28 05:32:16.939 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9740865230560303
2023-04-28 05:32:16.939 | INFO     | utils.logging:log_training_results:326 - val MCE loss:0.95796 * 0.5
2023-04-28 05:32:16.940 | INFO     | utils.logging:log_training_results:333 - val LLLR :0.24185 * 0.9
2023-04-28 05:32:16.940 | INFO     | utils.logging:log_training_results:340 - val weight decay:691.99084 * 0.0005
2023-04-28 05:32:17.007 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 05:32:17.023 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 2500.
2023-04-28 05:32:17.025 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-28 05:32:18.018 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 05:32:18.372 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:32:18.372 | INFO     | utils.logging:log_training_results:281 - Global Step =   2500
2023-04-28 05:32:18.373 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8313443064689636
2023-04-28 05:32:18.373 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.978926420211792
2023-04-28 05:32:18.373 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.953843355178833
2023-04-28 05:32:18.374 | INFO     | utils.logging:log_training_results:326 - train MCE loss:0.96430 * 0.5
2023-04-28 05:32:18.374 | INFO     | utils.logging:log_training_results:333 - train LLLR :0.24879 * 0.9
2023-04-28 05:32:18.375 | INFO     | utils.logging:log_training_results:340 - train weight decay:691.99078 * 0.0005
2023-04-28 05:32:37.502 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:32:37.504 | INFO     | utils.logging:log_training_results:281 - Global Step =   2750
2023-04-28 05:32:37.505 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8665499687194824
2023-04-28 05:32:37.505 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.6318378448486328
2023-04-28 05:32:37.506 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9735317230224609
2023-04-28 05:32:37.507 | INFO     | utils.logging:log_training_results:326 - val MCE loss:0.95717 * 0.5
2023-04-28 05:32:37.507 | INFO     | utils.logging:log_training_results:333 - val LLLR :0.24200 * 0.9
2023-04-28 05:32:37.508 | INFO     | utils.logging:log_training_results:340 - val weight decay:671.36908 * 0.0005
2023-04-28 05:32:38.540 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 05:32:38.880 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:32:38.881 | INFO     | utils.logging:log_training_results:281 - Global Step =   2750
2023-04-28 05:32:38.882 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8380541801452637
2023-04-28 05:32:38.882 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.9353877305984497
2023-04-28 05:32:38.883 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9682922959327698
2023-04-28 05:32:38.884 | INFO     | utils.logging:log_training_results:326 - train MCE loss:0.97334 * 0.5
2023-04-28 05:32:38.885 | INFO     | utils.logging:log_training_results:333 - train LLLR :0.24749 * 0.9
2023-04-28 05:32:38.885 | INFO     | utils.logging:log_training_results:340 - train weight decay:671.36902 * 0.0005
2023-04-28 05:32:42.310 | INFO     | __main__:objective:356 - Starting epoch #7.
2023-04-28 05:32:57.849 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:32:57.850 | INFO     | utils.logging:log_training_results:281 - Global Step =   3000
2023-04-28 05:32:57.850 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8677799701690674
2023-04-28 05:32:57.851 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.6416516304016113
2023-04-28 05:32:57.851 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9738385081291199
2023-04-28 05:32:57.852 | INFO     | utils.logging:log_training_results:326 - val MCE loss:0.95672 * 0.5
2023-04-28 05:32:57.852 | INFO     | utils.logging:log_training_results:333 - val LLLR :0.24166 * 0.9
2023-04-28 05:32:57.853 | INFO     | utils.logging:log_training_results:340 - val weight decay:651.45746 * 0.0005
2023-04-28 05:32:58.908 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 05:32:59.248 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:32:59.249 | INFO     | utils.logging:log_training_results:281 - Global Step =   3000
2023-04-28 05:32:59.250 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8257517218589783
2023-04-28 05:32:59.250 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.7471189498901367
2023-04-28 05:32:59.251 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9551223516464233
2023-04-28 05:32:59.251 | INFO     | utils.logging:log_training_results:326 - train MCE loss:0.98514 * 0.5
2023-04-28 05:32:59.251 | INFO     | utils.logging:log_training_results:333 - train LLLR :0.25015 * 0.9
2023-04-28 05:32:59.252 | INFO     | utils.logging:log_training_results:340 - train weight decay:651.45740 * 0.0005
2023-04-28 05:33:13.040 | INFO     | __main__:objective:356 - Starting epoch #8.
2023-04-28 05:33:18.224 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:33:18.225 | INFO     | utils.logging:log_training_results:281 - Global Step =   3250
2023-04-28 05:33:18.226 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8675466775894165
2023-04-28 05:33:18.226 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.631262183189392
2023-04-28 05:33:18.226 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9742586016654968
2023-04-28 05:33:18.227 | INFO     | utils.logging:log_training_results:326 - val MCE loss:0.95647 * 0.5
2023-04-28 05:33:18.227 | INFO     | utils.logging:log_training_results:333 - val LLLR :0.24168 * 0.9
2023-04-28 05:33:18.228 | INFO     | utils.logging:log_training_results:340 - val weight decay:632.31622 * 0.0005
2023-04-28 05:33:18.288 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 05:33:18.305 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 3250.
2023-04-28 05:33:18.309 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-28 05:33:19.595 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 05:33:19.956 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:33:19.957 | INFO     | utils.logging:log_training_results:281 - Global Step =   3250
2023-04-28 05:33:19.957 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8599680662155151
2023-04-28 05:33:19.958 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.9521517753601074
2023-04-28 05:33:19.958 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9591001868247986
2023-04-28 05:33:19.958 | INFO     | utils.logging:log_training_results:326 - train MCE loss:0.97168 * 0.5
2023-04-28 05:33:19.959 | INFO     | utils.logging:log_training_results:333 - train LLLR :0.24498 * 0.9
2023-04-28 05:33:19.959 | INFO     | utils.logging:log_training_results:340 - train weight decay:632.31622 * 0.0005
2023-04-28 05:33:39.396 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:33:39.397 | INFO     | utils.logging:log_training_results:281 - Global Step =   3500
2023-04-28 05:33:39.397 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8674366474151611
2023-04-28 05:33:39.398 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.6599763631820679
2023-04-28 05:33:39.398 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9747820496559143
2023-04-28 05:33:39.399 | INFO     | utils.logging:log_training_results:326 - val MCE loss:0.95649 * 0.5
2023-04-28 05:33:39.400 | INFO     | utils.logging:log_training_results:333 - val LLLR :0.24173 * 0.9
2023-04-28 05:33:39.400 | INFO     | utils.logging:log_training_results:340 - val weight decay:613.84894 * 0.0005
2023-04-28 05:33:39.473 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 05:33:39.491 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 3500.
2023-04-28 05:33:39.496 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-28 05:33:40.514 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 05:33:40.864 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:33:40.865 | INFO     | utils.logging:log_training_results:281 - Global Step =   3500
2023-04-28 05:33:40.865 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8207112550735474
2023-04-28 05:33:40.866 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.7931140661239624
2023-04-28 05:33:40.866 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9445997476577759
2023-04-28 05:33:40.867 | INFO     | utils.logging:log_training_results:326 - train MCE loss:0.97990 * 0.5
2023-04-28 05:33:40.872 | INFO     | utils.logging:log_training_results:333 - train LLLR :0.25228 * 0.9
2023-04-28 05:33:40.873 | INFO     | utils.logging:log_training_results:340 - train weight decay:613.84894 * 0.0005
2023-04-28 05:33:48.171 | INFO     | __main__:objective:356 - Starting epoch #9.
2023-04-28 05:34:00.452 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:34:00.453 | INFO     | utils.logging:log_training_results:281 - Global Step =   3750
2023-04-28 05:34:00.453 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8679533004760742
2023-04-28 05:34:00.453 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.624018669128418
2023-04-28 05:34:00.454 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9737444519996643
2023-04-28 05:34:00.455 | INFO     | utils.logging:log_training_results:326 - val MCE loss:0.95582 * 0.5
2023-04-28 05:34:00.455 | INFO     | utils.logging:log_training_results:333 - val LLLR :0.24168 * 0.9
2023-04-28 05:34:00.455 | INFO     | utils.logging:log_training_results:340 - val weight decay:596.06927 * 0.0005
2023-04-28 05:34:01.485 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 05:34:01.836 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 05:34:01.837 | INFO     | utils.logging:log_training_results:281 - Global Step =   3750
2023-04-28 05:34:01.838 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.8683173060417175
2023-04-28 05:34:01.838 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 1.9455803632736206
2023-04-28 05:34:01.838 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9531150460243225
2023-04-28 05:34:01.839 | INFO     | utils.logging:log_training_results:326 - train MCE loss:0.96893 * 0.5
2023-04-28 05:34:01.839 | INFO     | utils.logging:log_training_results:333 - train LLLR :0.24230 * 0.9
2023-04-28 05:34:01.839 | INFO     | utils.logging:log_training_results:340 - train weight decay:596.06927 * 0.0005
2023-04-28 05:34:19.265 | INFO     | utils.logging:investigate_log:155 - num_warning=0/num_error=0 in the .log file.
2023-04-28 05:34:19.521 | INFO     | optuna.study.study:_log_completed_trial:1020 - Trial 8 finished with value: 0.025217950344085693 and parameters: {'LIST_IS_POSITIONAL_ENCODING': True, 'LIST_IS_TRAINABLE_ENCODING': True, 'LIST_MODEL_BACKBONE': 'Transformer', 'LIST_WEIGHT_DECAY': 0.0005, 'LIST_LEARNING_RATE': 4.9775009712821886e-05, 'LIST_LLLR_VERSION': 'LLLR', 'LIST_ACTIVATION_FC': 'gelu', 'LIST_PARAM_MULTIPLET_LOSS': 0.5, 'LIST_PARAM_LLR_LOSS': 0.9, 'LIST_IS_ADAPTIVE_LOSS': False, 'LIST_ORDER_SPRT': 2, 'LIST_OPTIMIZER': 'adam', 'LIST_IS_NORMALIZE': False, 'LIST_NUM_THRESH': 500, 'LIST_SPARSITY': 'lograndom', 'LIST_NUM_BLOCKS': 1, 'LIST_NUM_HEADS': 2, 'LIST_DROPOUT': 0.4, 'LIST_FF_DIM': 32, 'LIST_MLP_UNITS': 64}. Best is trial 4 with value: 0.021068453788757324.
2023-04-28 05:34:19.545 | INFO     | utils.hyperparameter_tuning:suggest_parameters:560 - [33mStarting a tuning phase.[0m
2023-04-28 05:34:19.999 | INFO     | utils.hyperparameter_tuning:print:394 - 
+------------------------------------------+
|   Hyperparameteres suggested by Optuna   |
+------------------------+-----------------+
|     Parameter name     | Suggested value |
+------------------------+-----------------+
|     ACTIVATION_FC      |       gelu      |
|        DROPOUT         |       0.3       |
|         FF_DIM         |        64       |
|    IS_ADAPTIVE_LOSS    |       True      |
|      IS_NORMALIZE      |      False      |
| IS_POSITIONAL_ENCODING |       True      |
| IS_TRAINABLE_ENCODING  |       True      |
|     LEARNING_RATE      |    6.0988e-05   |
|      LLLR_VERSION      |       LSEL      |
|       MLP_UNITS        |        32       |
|     MODEL_BACKBONE     |   Transformer   |
|       NUM_BLOCKS       |        2        |
|       NUM_HEADS        |        4        |
|       NUM_THRESH       |       500       |
|       OPTIMIZER        |       adam      |
|       ORDER_SPRT       |        3        |
|     PARAM_LLR_LOSS     |       0.9       |
|  PARAM_MULTIPLET_LOSS  |       1.0       |
|        SPARSITY        |     linspace    |
|      WEIGHT_DECAY      |      0.0003     |
+------------------------+-----------------+
2023-04-28 05:34:20.002 | INFO     | utils.misc:create_directories_and_log:291 - [33mA new log directory was created: [0m/home/afe/Dropbox/GitHub/SPRT-TANDEM-PyTorch/logs/public_offset0_5_optimausat_confmx_tuning/checkpoints/Transformer_20230428_053420002/configs
2023-04-28 05:34:20.003 | INFO     | utils.misc:create_directories_and_log:291 - [33mA new log directory was created: [0m/home/afe/Dropbox/GitHub/SPRT-TANDEM-PyTorch/logs/public_offset0_5_optimausat_confmx_tuning/TensorBoard_events/Transformer_20230428_053420002
