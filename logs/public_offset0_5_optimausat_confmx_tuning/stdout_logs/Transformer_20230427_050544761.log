2023-04-27 05:05:44.782 | INFO     | utils.misc:fix_random_seed:405 - Random seed is not fixed.
2023-04-27 05:05:44.808 | ERROR    | __main__:objective:344 - An error has been caught in function 'objective', process 'MainProcess' (147488), thread 'MainThread' (140218498211840):
Traceback (most recent call last):

  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
           │         │     └ {'__name__': '__main__', '__doc__': None, '__package__': '', '__loader__': <_frozen_importlib_external.SourceFileLoader objec...
           │         └ <code object <module> at 0x7f8729a56b80, file "/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/...
           └ <function _run_code at 0x7f8729a9fac0>
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
         │     └ {'__name__': '__main__', '__doc__': None, '__package__': '', '__loader__': <_frozen_importlib_external.SourceFileLoader objec...
         └ <code object <module> at 0x7f8729a56b80, file "/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/...

  File "/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/__main__.py", line 39, in <module>
    cli.main()
    │   └ <function main at 0x7f872868ab90>
    └ <module 'debugpy.server.cli' from '/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/python/debug...

  File "/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py", line 430, in main
    run()
    └ <function run_file at 0x7f872868a950>

  File "/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py", line 284, in run_file
    runpy.run_path(target, run_name="__main__")
    │     │        └ '/home/afe/Dropbox/GitHub/TANDEMAUS/tandemaus_main.py'
    │     └ <function run_path at 0x7f8728a651b0>
    └ <module '_pydevd_bundle.pydevd_runpy' from '/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/pyt...

  File "/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 321, in run_path
    return _run_module_code(code, init_globals, run_name,
           │                │     │             └ '__main__'
           │                │     └ None
           │                └ <code object <module> at 0x7f87286af680, file "/home/afe/Dropbox/GitHub/TANDEMAUS/tandemaus_main.py", line 1>
           └ <function _run_module_code at 0x7f8728a64e50>

  File "/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 135, in _run_module_code
    _run_code(code, mod_globals, init_globals,
    │         │     │            └ None
    │         │     └ {'__name__': '__main__', '__doc__': None, '__package__': '', '__loader__': None, '__spec__': None, '__file__': '/home/afe/Dro...
    │         └ <code object <module> at 0x7f87286af680, file "/home/afe/Dropbox/GitHub/TANDEMAUS/tandemaus_main.py", line 1>
    └ <function _run_code at 0x7f8728a64a60>

  File "/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 124, in _run_code
    exec(code, run_globals)
         │     └ {'__name__': '__main__', '__doc__': None, '__package__': '', '__loader__': None, '__spec__': None, '__file__': '/home/afe/Dro...
         └ <code object <module> at 0x7f87286af680, file "/home/afe/Dropbox/GitHub/TANDEMAUS/tandemaus_main.py", line 1>

  File "/home/afe/Dropbox/GitHub/TANDEMAUS/tandemaus_main.py", line 390, in <module>
    main()
    └ <function main at 0x7f855b33fd90>

  File "/home/afe/Dropbox/GitHub/TANDEMAUS/tandemaus_main.py", line 384, in main
    run_optuna(objective, device, config_orig)
    │          │          │       └ {'VERBOSE': True, 'CONFIG_PATH': '/home/afe/Dropbox/GitHub/TANDEMAUS/config/config_definition.py', 'IS_SEED': False, 'SEED': ...
    │          │          └ device(type='cuda')
    │          └ <function objective at 0x7f855b33fd00>
    └ <function run_optuna at 0x7f855b4cce50>

  File "/home/afe/Dropbox/GitHub/TANDEMAUS/utils/hyperparameter_tuning.py", line 334, in run_optuna
    else start_optimization(objective, conf)
         │                  │          └ <utils.misc.ConfigSubset object at 0x7f855b366680>
         │                  └ <function objective at 0x7f855b33fd00>
         └ <function run_optuna.<locals>.start_optimization at 0x7f855b33ff40>

  File "/home/afe/Dropbox/GitHub/TANDEMAUS/utils/hyperparameter_tuning.py", line 208, in start_optimization
    study.optimize(
    │     └ <function Study.optimize at 0x7f855fc9cb80>
    └ <optuna.study.study.Study object at 0x7f8553c6cbb0>

  File "/usr/local/lib/python3.10/dist-packages/optuna/study/study.py", line 425, in optimize
    _optimize(
    └ <function _optimize at 0x7f855fc7af80>
  File "/usr/local/lib/python3.10/dist-packages/optuna/study/_optimize.py", line 66, in _optimize
    _optimize_sequential(
    └ <function _optimize_sequential at 0x7f855fc9c310>
  File "/usr/local/lib/python3.10/dist-packages/optuna/study/_optimize.py", line 163, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
                   │          │      │     └ ()
                   │          │      └ <function run_optuna.<locals>.start_optimization.<locals>.<lambda> at 0x7f8553cd0820>
                   │          └ <optuna.study.study.Study object at 0x7f8553c6cbb0>
                   └ <function _run_trial at 0x7f855fc9c3a0>
  File "/usr/local/lib/python3.10/dist-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
                      │    └ <optuna.trial._trial.Trial object at 0x7f8553d37dc0>
                      └ <function run_optuna.<locals>.start_optimization.<locals>.<lambda> at 0x7f8553cd0820>

  File "/home/afe/Dropbox/GitHub/TANDEMAUS/utils/hyperparameter_tuning.py", line 209, in <lambda>
    lambda trial: objective(trial, device, config),
           │      │         │      │       └ {'VERBOSE': True, 'CONFIG_PATH': '/home/afe/Dropbox/GitHub/TANDEMAUS/config/config_definition.py', 'IS_SEED': False, 'SEED': ...
           │      │         │      └ device(type='cuda')
           │      │         └ <optuna.trial._trial.Trial object at 0x7f8553d37dc0>
           │      └ <function objective at 0x7f855b33fd00>
           └ <optuna.trial._trial.Trial object at 0x7f8553d37dc0>

> File "/home/afe/Dropbox/GitHub/TANDEMAUS/tandemaus_main.py", line 344, in objective
    model, optimizer, data_loaders, tb_writer = prepare_for_training(
                                                └ <function prepare_for_training at 0x7f855b33f2e0>

  File "/home/afe/Dropbox/GitHub/TANDEMAUS/tandemaus_main.py", line 75, in prepare_for_training
    model = import_model(config, device, tb_writer=None)
            │            │       └ device(type='cuda')
            │            └ {'VERBOSE': True, 'CONFIG_PATH': '/home/afe/Dropbox/GitHub/TANDEMAUS/config/config_definition.py', 'IS_SEED': False, 'SEED': ...
            └ <function import_model at 0x7f855b4ceef0>

  File "/home/afe/Dropbox/GitHub/TANDEMAUS/models/temporal_integrators.py", line 49, in import_model
    model = TANDEMformer(config)
            │            └ {'VERBOSE': True, 'CONFIG_PATH': '/home/afe/Dropbox/GitHub/TANDEMAUS/config/config_definition.py', 'IS_SEED': False, 'SEED': ...
            └ <class 'models.temporal_integrators.TANDEMformer'>

  File "/home/afe/Dropbox/GitHub/TANDEMAUS/models/temporal_integrators.py", line 686, in __init__
    if self.is_tapering_threshold:
       └ TANDEMformer(
           (dropout): Dropout(p=0.5, inplace=False)
           (pos_encoder): PositionalEncoding(
             (dropout): Dropout(p=0.5, i...

  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1614, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(

AttributeError: 'TANDEMformer' object has no attribute 'is_tapering_threshold'
2023-04-27 05:05:44.831 | INFO     | utils.logging:investigate_log:155 - num_warning=0/num_error=1 in the .log file.
2023-04-27 05:05:44.832 | WARNING  | utils.logging:investigate_log:161 - Found ERROR! check the .log file for debug!
2023-04-27 05:05:44.867 | WARNING  | optuna.study._optimize:_log_failed_trial:261 - Trial 1 failed with parameters: {'LIST_IS_POSITIONAL_ENCODING': False, 'LIST_MODEL_BACKBONE': 'Transformer', 'LIST_WEIGHT_DECAY': 0.001, 'LIST_LEARNING_RATE': 9.808181066770128e-06, 'LIST_LLLR_VERSION': 'E', 'LIST_ACTIVATION_FC': 'gelu', 'LIST_PARAM_MULTIPLET_LOSS': 0.9, 'LIST_PARAM_LLR_LOSS': 0.2, 'LIST_IS_ADAPTIVE_LOSS': True, 'LIST_ORDER_SPRT': 3, 'LIST_OPTIMIZER': 'rmsprop', 'LIST_IS_NORMALIZE': False, 'LIST_NUM_THRESH': 500, 'LIST_SPARSITY': 'logspace', 'LIST_NUM_BLOCKS': 2, 'LIST_NUM_HEADS': 4, 'LIST_DROPOUT': 0.5, 'LIST_FF_DIM': 64, 'LIST_MLP_UNITS': 32} because of the following error: TypeError('cannot unpack non-iterable NoneType object').
Traceback (most recent call last):

  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
           │         │     └ {'__name__': '__main__', '__doc__': None, '__package__': '', '__loader__': <_frozen_importlib_external.SourceFileLoader objec...
           │         └ <code object <module> at 0x7f8729a56b80, file "/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/...
           └ <function _run_code at 0x7f8729a9fac0>
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
         │     └ {'__name__': '__main__', '__doc__': None, '__package__': '', '__loader__': <_frozen_importlib_external.SourceFileLoader objec...
         └ <code object <module> at 0x7f8729a56b80, file "/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/...

  File "/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/__main__.py", line 39, in <module>
    cli.main()
    │   └ <function main at 0x7f872868ab90>
    └ <module 'debugpy.server.cli' from '/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/python/debug...

  File "/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py", line 430, in main
    run()
    └ <function run_file at 0x7f872868a950>

  File "/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py", line 284, in run_file
    runpy.run_path(target, run_name="__main__")
    │     │        └ '/home/afe/Dropbox/GitHub/TANDEMAUS/tandemaus_main.py'
    │     └ <function run_path at 0x7f8728a651b0>
    └ <module '_pydevd_bundle.pydevd_runpy' from '/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/pyt...

  File "/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 321, in run_path
    return _run_module_code(code, init_globals, run_name,
           │                │     │             └ '__main__'
           │                │     └ None
           │                └ <code object <module> at 0x7f87286af680, file "/home/afe/Dropbox/GitHub/TANDEMAUS/tandemaus_main.py", line 1>
           └ <function _run_module_code at 0x7f8728a64e50>

  File "/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 135, in _run_module_code
    _run_code(code, mod_globals, init_globals,
    │         │     │            └ None
    │         │     └ {'__name__': '__main__', '__doc__': None, '__package__': '', '__loader__': None, '__spec__': None, '__file__': '/home/afe/Dro...
    │         └ <code object <module> at 0x7f87286af680, file "/home/afe/Dropbox/GitHub/TANDEMAUS/tandemaus_main.py", line 1>
    └ <function _run_code at 0x7f8728a64a60>

  File "/home/afe/.vscode-server/extensions/ms-python.python-2023.6.1/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 124, in _run_code
    exec(code, run_globals)
         │     └ {'__name__': '__main__', '__doc__': None, '__package__': '', '__loader__': None, '__spec__': None, '__file__': '/home/afe/Dro...
         └ <code object <module> at 0x7f87286af680, file "/home/afe/Dropbox/GitHub/TANDEMAUS/tandemaus_main.py", line 1>

  File "/home/afe/Dropbox/GitHub/TANDEMAUS/tandemaus_main.py", line 390, in <module>
    main()
    └ <function main at 0x7f855b33fd90>

  File "/home/afe/Dropbox/GitHub/TANDEMAUS/tandemaus_main.py", line 384, in main
    run_optuna(objective, device, config_orig)
    │          │          │       └ {'VERBOSE': True, 'CONFIG_PATH': '/home/afe/Dropbox/GitHub/TANDEMAUS/config/config_definition.py', 'IS_SEED': False, 'SEED': ...
    │          │          └ device(type='cuda')
    │          └ <function objective at 0x7f855b33fd00>
    └ <function run_optuna at 0x7f855b4cce50>

  File "/home/afe/Dropbox/GitHub/TANDEMAUS/utils/hyperparameter_tuning.py", line 334, in run_optuna
    else start_optimization(objective, conf)
         │                  │          └ <utils.misc.ConfigSubset object at 0x7f855b366680>
         │                  └ <function objective at 0x7f855b33fd00>
         └ <function run_optuna.<locals>.start_optimization at 0x7f855b33ff40>

  File "/home/afe/Dropbox/GitHub/TANDEMAUS/utils/hyperparameter_tuning.py", line 208, in start_optimization
    study.optimize(
    │     └ <function Study.optimize at 0x7f855fc9cb80>
    └ <optuna.study.study.Study object at 0x7f8553c6cbb0>

  File "/usr/local/lib/python3.10/dist-packages/optuna/study/study.py", line 425, in optimize
    _optimize(
    └ <function _optimize at 0x7f855fc7af80>
  File "/usr/local/lib/python3.10/dist-packages/optuna/study/_optimize.py", line 66, in _optimize
    _optimize_sequential(
    └ <function _optimize_sequential at 0x7f855fc9c310>
  File "/usr/local/lib/python3.10/dist-packages/optuna/study/_optimize.py", line 163, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
                   │          │      │     └ ()
                   │          │      └ <function run_optuna.<locals>.start_optimization.<locals>.<lambda> at 0x7f8553cd0820>
                   │          └ <optuna.study.study.Study object at 0x7f8553c6cbb0>
                   └ <function _run_trial at 0x7f855fc9c3a0>
> File "/usr/local/lib/python3.10/dist-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
                      │    └ <optuna.trial._trial.Trial object at 0x7f8553d37dc0>
                      └ <function run_optuna.<locals>.start_optimization.<locals>.<lambda> at 0x7f8553cd0820>

  File "/home/afe/Dropbox/GitHub/TANDEMAUS/utils/hyperparameter_tuning.py", line 209, in <lambda>
    lambda trial: objective(trial, device, config),
           │      │         │      │       └ {'VERBOSE': True, 'CONFIG_PATH': '/home/afe/Dropbox/GitHub/TANDEMAUS/config/config_definition.py', 'IS_SEED': False, 'SEED': ...
           │      │         │      └ device(type='cuda')
           │      │         └ <optuna.trial._trial.Trial object at 0x7f8553d37dc0>
           │      └ <function objective at 0x7f855b33fd00>
           └ <optuna.trial._trial.Trial object at 0x7f8553d37dc0>

  File "/home/afe/Dropbox/GitHub/TANDEMAUS/tandemaus_main.py", line 344, in objective
    model, optimizer, data_loaders, tb_writer = prepare_for_training(
                                                └ <function prepare_for_training at 0x7f855b33f2e0>

TypeError: cannot unpack non-iterable NoneType object
2023-04-27 05:05:44.881 | WARNING  | optuna.study._optimize:_log_failed_trial:268 - Trial 1 failed with value None.
2023-04-27 05:05:44.899 | INFO     | utils.misc:__exit__:207 - elapsed time:  0.000258 hours. ()
2023-04-27 05:05:44.902 | INFO     | utils.misc:__exit__:208 - Memory usage: 18.26 megabytes
