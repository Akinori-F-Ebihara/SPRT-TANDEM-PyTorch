2023-04-28 16:33:28.333 | INFO     | utils.misc:fix_random_seed:405 - Random seed is not fixed.
2023-04-28 16:33:28.359 | INFO     | models.temporal_integrators:summarize:568 - 
:'######::'########::'########::'########::::::::::::::::::::::
'##... ##: ##.... ##: ##.... ##:... ##..:::::::::::::::::::::::
 ##:::..:: ##:::: ##: ##:::: ##:::: ##:::::::::::::::::::::::::
. ######:: ########:: ########::::: ##::::'#######:::::::::::::
:..... ##: ##.....::: ##.. ##:::::: ##::::........:::::::::::::
'##::: ##: ##:::::::: ##::. ##::::: ##:::::::::::::::::::::::::
. ######:: ##:::::::: ##:::. ##:::: ##:::::::::::::::::::::::::
:......:::..:::::::::..:::::..:::::..::::::::::::::::::::::::::
'########::::'###::::'##::: ##:'########::'########:'##::::'##:
... ##..::::'## ##::: ###:: ##: ##.... ##: ##.....:: ###::'###:
::: ##:::::'##:. ##:: ####: ##: ##:::: ##: ##::::::: ####'####:
::: ##::::'##:::. ##: ## ## ##: ##:::: ##: ######::: ## ### ##:
::: ##:::: #########: ##. ####: ##:::: ##: ##...:::: ##. #: ##:
::: ##:::: ##.... ##: ##:. ###: ##:::: ##: ##::::::: ##:.:: ##:
::: ##:::: ##:::: ##: ##::. ##: ########:: ########: ##:::: ##:
:::..:::::..:::::..::..::::..::........:::........::..:::::..::

2023-04-28 16:33:28.360 | INFO     | models.temporal_integrators:summarize:571 - [34mofficial PyTorch implementation.[0m
2023-04-28 16:33:28.422 | INFO     | models.temporal_integrators:summarize:593 - Network summary:
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
TANDEMformer                                  [150, 50, 3, 3]           3
â”œâ”€PositionalEncoding: 1-1                     [7350, 1, 128]            --
â”‚    â””â”€Dropout: 2-1                           [1, 7350, 128]            --
â”œâ”€TransformerEncoder: 1-2                     [7350, 1, 128]            --
â”‚    â””â”€ModuleList: 2-4                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-1      [7350, 1, 128]            74,912
â”œâ”€Linear: 1-3                                 [7350, 32]                4,128
â”œâ”€Dropout: 1-4                                [7350, 32]                --
â”œâ”€PositionalEncoding: 1-5                     [7350, 2, 128]            --
â”‚    â””â”€Dropout: 2-3                           [2, 7350, 128]            --
â”œâ”€TransformerEncoder: 1-6                     [7350, 2, 128]            (recursive)
â”‚    â””â”€ModuleList: 2-4                        --                        (recursive)
â”‚    â”‚    â””â”€TransformerEncoderLayer: 3-2      [7350, 2, 128]            (recursive)
â”œâ”€Linear: 1-7                                 [7350, 32]                (recursive)
â”œâ”€Dropout: 1-8                                [7350, 32]                --
â”œâ”€ReLU: 1-9                                   [7350, 32]                --
â”œâ”€Linear: 1-10                                [7350, 3]                 99
â”œâ”€ReLU: 1-11                                  [7350, 32]                --
â”œâ”€Linear: 1-12                                [7350, 3]                 (recursive)
===============================================================================================
Total params: 79,142
Trainable params: 79,142
Non-trainable params: 0
Total mult-adds (M): 62.14
===============================================================================================
Input size (MB): 3.84
Forward/backward pass size (MB): 4.12
Params size (MB): 0.02
Estimated Total Size (MB): 7.97
===============================================================================================
2023-04-28 16:33:28.423 | INFO     | models.temporal_integrators:summarize:594 - Example input shape: torch.Size([150, 50, 128])
2023-04-28 16:33:28.424 | INFO     | models.temporal_integrators:summarize:595 - Example output shape: torch.Size([150, 50, 3, 3])
2023-04-28 16:33:28.426 | INFO     | models.temporal_integrators:import_model:58 - model moved onto: [33mcuda.[0m
2023-04-28 16:33:28.427 | INFO     | models.optimizers:initialize_optimizer:44 - Optimizer:
AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0003590323237284956
    maximize: False
    weight_decay: 0.0002
)
2023-04-28 16:33:28.427 | INFO     | datasets.data_processing:lmdb_dataloaders:293 - loading data... 
2023-04-28 16:33:28.428 | INFO     | datasets.data_processing:lmdb_dataloaders:295 - If this process takes long, consider setting is_load_onto_memory=False or use LMDBIterableDataset.
2023-04-28 16:33:30.723 | INFO     | __main__:objective:356 - Starting epoch #0.
2023-04-28 16:33:33.020 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:33:33.021 | INFO     | utils.logging:log_training_results:281 - Global Step =      0
2023-04-28 16:33:33.021 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.3399899899959564
2023-04-28 16:33:33.021 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 3.5349719524383545
2023-04-28 16:33:33.022 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.3332116901874542
2023-04-28 16:33:33.022 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.10186 * 0.8 * 0.79000
2023-04-28 16:33:33.023 | INFO     | utils.logging:log_training_results:309 - val LLLR :1.48051 * 0.6000000000000001 * -0.20186
2023-04-28 16:33:33.023 | INFO     | utils.logging:log_training_results:317 - val weight decay:557.56293 * 0.0002 * -0.06980
2023-04-28 16:33:34.137 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:33:34.451 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:33:34.451 | INFO     | utils.logging:log_training_results:281 - Global Step =      0
2023-04-28 16:33:34.452 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.3430800437927246
2023-04-28 16:33:34.452 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 3.7158660888671875
2023-04-28 16:33:34.453 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.32910576462745667
2023-04-28 16:33:34.453 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.10608 * 0.8 * 0.78964
2023-04-28 16:33:34.453 | INFO     | utils.logging:log_training_results:309 - train LLLR :1.54098 * 0.6000000000000001 * -0.20221
2023-04-28 16:33:34.454 | INFO     | utils.logging:log_training_results:317 - train weight decay:557.56287 * 0.0002 * -0.07016
2023-04-28 16:33:55.581 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:33:55.582 | INFO     | utils.logging:log_training_results:281 - Global Step =    250
2023-04-28 16:33:55.582 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8640633225440979
2023-04-28 16:33:55.583 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 2.2100563049316406
2023-04-28 16:33:55.583 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9778101444244385
2023-04-28 16:33:55.584 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.03407 * 0.8 * 0.70895
2023-04-28 16:33:55.584 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.41400 * 0.6000000000000001 * -0.25918
2023-04-28 16:33:55.585 | INFO     | utils.logging:log_training_results:317 - val weight decay:466.22736 * 0.0002 * -0.12108
2023-04-28 16:33:55.711 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 16:33:55.726 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 250.
2023-04-28 16:33:56.520 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:33:56.827 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:33:56.828 | INFO     | utils.logging:log_training_results:281 - Global Step =    250
2023-04-28 16:33:56.828 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7090280055999756
2023-04-28 16:33:56.828 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.5791056156158447
2023-04-28 16:33:56.829 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.8145856261253357
2023-04-28 16:33:56.829 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.05522 * 0.8 * 0.70868
2023-04-28 16:33:56.829 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.63543 * 0.6000000000000001 * -0.25934
2023-04-28 16:33:56.830 | INFO     | utils.logging:log_training_results:317 - train weight decay:466.22733 * 0.0002 * -0.12120
2023-04-28 16:34:07.840 | INFO     | __main__:objective:356 - Starting epoch #1.
2023-04-28 16:34:17.510 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:34:17.511 | INFO     | utils.logging:log_training_results:281 - Global Step =    500
2023-04-28 16:34:17.511 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8691833019256592
2023-04-28 16:34:17.512 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 2.004380941390991
2023-04-28 16:34:17.512 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9798064827919006
2023-04-28 16:34:17.513 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.02881 * 0.8 * 0.66193
2023-04-28 16:34:17.513 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.37991 * 0.6000000000000001 * -0.29323
2023-04-28 16:34:17.514 | INFO     | utils.logging:log_training_results:317 - val weight decay:419.31168 * 0.0002 * -0.14383
2023-04-28 16:34:17.642 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 16:34:17.655 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 500.
2023-04-28 16:34:17.658 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-28 16:34:18.423 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:34:18.739 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:34:18.740 | INFO     | utils.logging:log_training_results:281 - Global Step =    500
2023-04-28 16:34:18.740 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.6848734021186829
2023-04-28 16:34:18.740 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.5100674629211426
2023-04-28 16:34:18.741 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.8418418169021606
2023-04-28 16:34:18.741 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.05257 * 0.8 * 0.66183
2023-04-28 16:34:18.741 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.66713 * 0.6000000000000001 * -0.29335
2023-04-28 16:34:18.742 | INFO     | utils.logging:log_training_results:317 - train weight decay:419.31168 * 0.0002 * -0.14390
2023-04-28 16:34:39.002 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:34:39.002 | INFO     | utils.logging:log_training_results:281 - Global Step =    750
2023-04-28 16:34:39.003 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8672666549682617
2023-04-28 16:34:39.003 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.8915350437164307
2023-04-28 16:34:39.003 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9802424907684326
2023-04-28 16:34:39.004 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.02756 * 0.8 * 0.64902
2023-04-28 16:34:39.004 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.36696 * 0.6000000000000001 * -0.31841
2023-04-28 16:34:39.005 | INFO     | utils.logging:log_training_results:317 - val weight decay:384.69629 * 0.0002 * -0.15767
2023-04-28 16:34:39.130 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 16:34:39.143 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 750.
2023-04-28 16:34:39.146 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-28 16:34:39.914 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:34:40.225 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:34:40.226 | INFO     | utils.logging:log_training_results:281 - Global Step =    750
2023-04-28 16:34:40.226 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7236691117286682
2023-04-28 16:34:40.226 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.3583550453186035
2023-04-28 16:34:40.227 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9075679183006287
2023-04-28 16:34:40.227 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.05407 * 0.8 * 0.64900
2023-04-28 16:34:40.228 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.65643 * 0.6000000000000001 * -0.31850
2023-04-28 16:34:40.228 | INFO     | utils.logging:log_training_results:317 - train weight decay:384.69629 * 0.0002 * -0.15771
2023-04-28 16:34:43.932 | INFO     | __main__:objective:356 - Starting epoch #2.
2023-04-28 16:35:00.883 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:35:00.883 | INFO     | utils.logging:log_training_results:281 - Global Step =   1000
2023-04-28 16:35:00.884 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8565199971199036
2023-04-28 16:35:00.884 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.856459140777588
2023-04-28 16:35:00.885 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9722560048103333
2023-04-28 16:35:00.885 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.02919 * 0.8 * 0.64759
2023-04-28 16:35:00.886 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.37602 * 0.6000000000000001 * -0.33864
2023-04-28 16:35:00.886 | INFO     | utils.logging:log_training_results:317 - val weight decay:355.35107 * 0.0002 * -0.16635
2023-04-28 16:35:01.850 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:35:02.169 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:35:02.169 | INFO     | utils.logging:log_training_results:281 - Global Step =   1000
2023-04-28 16:35:02.170 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7009230852127075
2023-04-28 16:35:02.170 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.260838747024536
2023-04-28 16:35:02.170 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.8324090242385864
2023-04-28 16:35:02.171 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.05262 * 0.8 * 0.64759
2023-04-28 16:35:02.171 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.67062 * 0.6000000000000001 * -0.33871
2023-04-28 16:35:02.171 | INFO     | utils.logging:log_training_results:317 - train weight decay:355.35107 * 0.0002 * -0.16638
2023-04-28 16:35:16.810 | INFO     | __main__:objective:356 - Starting epoch #3.
2023-04-28 16:35:22.762 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:35:22.762 | INFO     | utils.logging:log_training_results:281 - Global Step =   1250
2023-04-28 16:35:22.763 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8684399724006653
2023-04-28 16:35:22.763 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.7214388847351074
2023-04-28 16:35:22.763 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9804776310920715
2023-04-28 16:35:22.764 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.02674 * 0.8 * 0.64747
2023-04-28 16:35:22.764 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.35055 * 0.6000000000000001 * -0.35442
2023-04-28 16:35:22.765 | INFO     | utils.logging:log_training_results:317 - val weight decay:328.61530 * 0.0002 * -0.17130
2023-04-28 16:35:22.888 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 16:35:22.901 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 1250.
2023-04-28 16:35:22.903 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-28 16:35:23.668 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:35:23.993 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:35:23.993 | INFO     | utils.logging:log_training_results:281 - Global Step =   1250
2023-04-28 16:35:23.994 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7249113321304321
2023-04-28 16:35:23.994 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.278900146484375
2023-04-28 16:35:23.994 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.8740077018737793
2023-04-28 16:35:23.995 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.05112 * 0.8 * 0.64747
2023-04-28 16:35:23.995 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.59117 * 0.6000000000000001 * -0.35448
2023-04-28 16:35:23.996 | INFO     | utils.logging:log_training_results:317 - train weight decay:328.61530 * 0.0002 * -0.17131
2023-04-28 16:35:44.455 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:35:44.455 | INFO     | utils.logging:log_training_results:281 - Global Step =   1500
2023-04-28 16:35:44.456 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8642966747283936
2023-04-28 16:35:44.456 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.7123974561691284
2023-04-28 16:35:44.457 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.977715015411377
2023-04-28 16:35:44.457 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.02779 * 0.8 * 0.64749
2023-04-28 16:35:44.457 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.35461 * 0.6000000000000001 * -0.36736
2023-04-28 16:35:44.458 | INFO     | utils.logging:log_training_results:317 - val weight decay:303.29059 * 0.0002 * -0.17316
2023-04-28 16:35:45.534 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:35:45.897 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:35:45.897 | INFO     | utils.logging:log_training_results:281 - Global Step =   1500
2023-04-28 16:35:45.898 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7620763778686523
2023-04-28 16:35:45.898 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.282438039779663
2023-04-28 16:35:45.898 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9232084155082703
2023-04-28 16:35:45.899 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.05208 * 0.8 * 0.64749
2023-04-28 16:35:45.899 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.55847 * 0.6000000000000001 * -0.36741
2023-04-28 16:35:45.900 | INFO     | utils.logging:log_training_results:317 - train weight decay:303.29056 * 0.0002 * -0.17317
2023-04-28 16:35:53.392 | INFO     | __main__:objective:356 - Starting epoch #4.
2023-04-28 16:36:06.696 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:36:06.696 | INFO     | utils.logging:log_training_results:281 - Global Step =   1750
2023-04-28 16:36:06.697 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8664700388908386
2023-04-28 16:36:06.698 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.6757111549377441
2023-04-28 16:36:06.698 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9796886444091797
2023-04-28 16:36:06.699 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.02833 * 0.8 * 0.64757
2023-04-28 16:36:06.700 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.34999 * 0.6000000000000001 * -0.37815
2023-04-28 16:36:06.700 | INFO     | utils.logging:log_training_results:317 - val weight decay:278.55563 * 0.0002 * -0.17229
2023-04-28 16:36:07.616 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:36:07.933 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:36:07.933 | INFO     | utils.logging:log_training_results:281 - Global Step =   1750
2023-04-28 16:36:07.934 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7551495432853699
2023-04-28 16:36:07.934 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.1649162769317627
2023-04-28 16:36:07.934 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.8842822909355164
2023-04-28 16:36:07.935 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.05167 * 0.8 * 0.64757
2023-04-28 16:36:07.935 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.57025 * 0.6000000000000001 * -0.37819
2023-04-28 16:36:07.935 | INFO     | utils.logging:log_training_results:317 - train weight decay:278.55563 * 0.0002 * -0.17228
2023-04-28 16:36:26.290 | INFO     | __main__:objective:356 - Starting epoch #5.
2023-04-28 16:36:28.611 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:36:28.612 | INFO     | utils.logging:log_training_results:281 - Global Step =   2000
2023-04-28 16:36:28.612 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8488433361053467
2023-04-28 16:36:28.613 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.7192351818084717
2023-04-28 16:36:28.613 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9647472500801086
2023-04-28 16:36:28.613 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.02932 * 0.8 * 0.64745
2023-04-28 16:36:28.614 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.37601 * 0.6000000000000001 * -0.38658
2023-04-28 16:36:28.614 | INFO     | utils.logging:log_training_results:317 - val weight decay:254.08130 * 0.0002 * -0.16887
2023-04-28 16:36:30.330 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:36:30.652 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:36:30.653 | INFO     | utils.logging:log_training_results:281 - Global Step =   2000
2023-04-28 16:36:30.653 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.787187933921814
2023-04-28 16:36:30.653 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.3020968437194824
2023-04-28 16:36:30.654 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9210924506187439
2023-04-28 16:36:30.654 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.04504 * 0.8 * 0.64745
2023-04-28 16:36:30.654 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.50215 * 0.6000000000000001 * -0.38661
2023-04-28 16:36:30.655 | INFO     | utils.logging:log_training_results:317 - train weight decay:254.08130 * 0.0002 * -0.16885
2023-04-28 16:36:50.820 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:36:50.821 | INFO     | utils.logging:log_training_results:281 - Global Step =   2250
2023-04-28 16:36:50.821 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8501200079917908
2023-04-28 16:36:50.822 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.6973825693130493
2023-04-28 16:36:50.822 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9630002975463867
2023-04-28 16:36:50.823 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.02985 * 0.8 * 0.64767
2023-04-28 16:36:50.823 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.37365 * 0.6000000000000001 * -0.39331
2023-04-28 16:36:50.823 | INFO     | utils.logging:log_training_results:317 - val weight decay:229.71550 * 0.0002 * -0.16304
2023-04-28 16:36:51.734 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:36:52.060 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:36:52.061 | INFO     | utils.logging:log_training_results:281 - Global Step =   2250
2023-04-28 16:36:52.061 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7652044296264648
2023-04-28 16:36:52.062 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.2318062782287598
2023-04-28 16:36:52.062 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9072828888893127
2023-04-28 16:36:52.063 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.05190 * 0.8 * 0.64767
2023-04-28 16:36:52.063 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.52989 * 0.6000000000000001 * -0.39333
2023-04-28 16:36:52.063 | INFO     | utils.logging:log_training_results:317 - train weight decay:229.71550 * 0.0002 * -0.16301
2023-04-28 16:37:02.814 | INFO     | __main__:objective:356 - Starting epoch #6.
2023-04-28 16:37:12.202 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:37:12.203 | INFO     | utils.logging:log_training_results:281 - Global Step =   2500
2023-04-28 16:37:12.203 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8575300574302673
2023-04-28 16:37:12.203 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.6339670419692993
2023-04-28 16:37:12.204 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9707310199737549
2023-04-28 16:37:12.204 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.02955 * 0.8 * 0.64749
2023-04-28 16:37:12.205 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.35991 * 0.6000000000000001 * -0.39836
2023-04-28 16:37:12.205 | INFO     | utils.logging:log_training_results:317 - val weight decay:204.96983 * 0.0002 * -0.15498
2023-04-28 16:37:13.093 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:37:13.408 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:37:13.408 | INFO     | utils.logging:log_training_results:281 - Global Step =   2500
2023-04-28 16:37:13.409 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7587697505950928
2023-04-28 16:37:13.409 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.2567999362945557
2023-04-28 16:37:13.409 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.8803372979164124
2023-04-28 16:37:13.410 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.04644 * 0.8 * 0.64749
2023-04-28 16:37:13.410 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.55796 * 0.6000000000000001 * -0.39838
2023-04-28 16:37:13.410 | INFO     | utils.logging:log_training_results:317 - train weight decay:204.96983 * 0.0002 * -0.15494
2023-04-28 16:37:33.830 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:37:33.830 | INFO     | utils.logging:log_training_results:281 - Global Step =   2750
2023-04-28 16:37:33.831 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8696867227554321
2023-04-28 16:37:33.831 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.5006109476089478
2023-04-28 16:37:33.831 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9813421368598938
2023-04-28 16:37:33.832 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.02755 * 0.8 * 0.64754
2023-04-28 16:37:33.832 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.33655 * 0.6000000000000001 * -0.40178
2023-04-28 16:37:33.833 | INFO     | utils.logging:log_training_results:317 - val weight decay:179.70132 * 0.0002 * -0.14490
2023-04-28 16:37:33.953 | INFO     | utils.checkpoint:update_and_save_result:168 - [36mBest value updated![0m
2023-04-28 16:37:33.967 | INFO     | utils.checkpoint:save_checkpoint:83 - [36mSaved checkpoint[0m at step 2750.
2023-04-28 16:37:33.970 | INFO     | utils.checkpoint:keep_max_num_saved_models:101 - Removed the oldest model for max_to_keep=1
2023-04-28 16:37:34.782 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:37:35.100 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:37:35.101 | INFO     | utils.logging:log_training_results:281 - Global Step =   2750
2023-04-28 16:37:35.101 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7312484383583069
2023-04-28 16:37:35.102 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.1758499145507812
2023-04-28 16:37:35.102 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9059469103813171
2023-04-28 16:37:35.103 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.05106 * 0.8 * 0.64754
2023-04-28 16:37:35.103 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.59628 * 0.6000000000000001 * -0.40179
2023-04-28 16:37:35.103 | INFO     | utils.logging:log_training_results:317 - train weight decay:179.70131 * 0.0002 * -0.14486
2023-04-28 16:37:39.117 | INFO     | __main__:objective:356 - Starting epoch #7.
2023-04-28 16:37:55.821 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:37:55.822 | INFO     | utils.logging:log_training_results:281 - Global Step =   3000
2023-04-28 16:37:55.822 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8571100234985352
2023-04-28 16:37:55.823 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.5486750602722168
2023-04-28 16:37:55.823 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9691810011863708
2023-04-28 16:37:55.824 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.02828 * 0.8 * 0.64722
2023-04-28 16:37:55.825 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.35637 * 0.6000000000000001 * -0.40455
2023-04-28 16:37:55.825 | INFO     | utils.logging:log_training_results:317 - val weight decay:153.66772 * 0.0002 * -0.13311
2023-04-28 16:37:56.726 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:37:57.045 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:37:57.046 | INFO     | utils.logging:log_training_results:281 - Global Step =   3000
2023-04-28 16:37:57.046 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7732648849487305
2023-04-28 16:37:57.047 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.102526903152466
2023-04-28 16:37:57.047 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.8879989385604858
2023-04-28 16:37:57.048 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.05068 * 0.8 * 0.64720
2023-04-28 16:37:57.048 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.56178 * 0.6000000000000001 * -0.40455
2023-04-28 16:37:57.048 | INFO     | utils.logging:log_training_results:317 - train weight decay:153.66772 * 0.0002 * -0.13306
2023-04-28 16:38:11.659 | INFO     | __main__:objective:356 - Starting epoch #8.
2023-04-28 16:38:17.445 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:38:17.445 | INFO     | utils.logging:log_training_results:281 - Global Step =   3250
2023-04-28 16:38:17.446 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8643200397491455
2023-04-28 16:38:17.446 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.6098356246948242
2023-04-28 16:38:17.446 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9776415228843689
2023-04-28 16:38:17.447 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.03052 * 0.8 * 0.64720
2023-04-28 16:38:17.447 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.35038 * 0.6000000000000001 * -0.40656
2023-04-28 16:38:17.448 | INFO     | utils.logging:log_training_results:317 - val weight decay:127.48502 * 0.0002 * -0.11999
2023-04-28 16:38:18.532 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:38:18.867 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:38:18.868 | INFO     | utils.logging:log_training_results:281 - Global Step =   3250
2023-04-28 16:38:18.868 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.768528401851654
2023-04-28 16:38:18.868 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.182081460952759
2023-04-28 16:38:18.869 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.8843715190887451
2023-04-28 16:38:18.869 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.04938 * 0.8 * 0.64721
2023-04-28 16:38:18.869 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.53720 * 0.6000000000000001 * -0.40657
2023-04-28 16:38:18.870 | INFO     | utils.logging:log_training_results:317 - train weight decay:127.48502 * 0.0002 * -0.11994
2023-04-28 16:38:39.752 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:38:39.752 | INFO     | utils.logging:log_training_results:281 - Global Step =   3500
2023-04-28 16:38:39.753 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.866606593132019
2023-04-28 16:38:39.753 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.5497747659683228
2023-04-28 16:38:39.754 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9791086912155151
2023-04-28 16:38:39.754 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.02726 * 0.8 * 0.64618
2023-04-28 16:38:39.754 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.34372 * 0.6000000000000001 * -0.40714
2023-04-28 16:38:39.755 | INFO     | utils.logging:log_training_results:317 - val weight decay:101.22121 * 0.0002 * -0.10583
2023-04-28 16:38:40.675 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:38:40.997 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:38:40.998 | INFO     | utils.logging:log_training_results:281 - Global Step =   3500
2023-04-28 16:38:40.998 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7683312892913818
2023-04-28 16:38:40.998 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.1036500930786133
2023-04-28 16:38:40.999 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9259575009346008
2023-04-28 16:38:40.999 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.04798 * 0.8 * 0.64618
2023-04-28 16:38:40.999 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.52853 * 0.6000000000000001 * -0.40714
2023-04-28 16:38:41.000 | INFO     | utils.logging:log_training_results:317 - train weight decay:101.22121 * 0.0002 * -0.10577
2023-04-28 16:38:48.365 | INFO     | __main__:objective:356 - Starting epoch #9.
2023-04-28 16:39:01.619 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:39:01.620 | INFO     | utils.logging:log_training_results:281 - Global Step =   3750
2023-04-28 16:39:01.620 | INFO     | utils.logging:log_training_results:282 - val mean(MacRec)_t: 0.8668400645256042
2023-04-28 16:39:01.621 | INFO     | utils.logging:log_training_results:287 - val mean ABSerr: 1.5747989416122437
2023-04-28 16:39:01.621 | INFO     | utils.logging:log_training_results:290 - val ausat from confmx: 0.9774509072303772
2023-04-28 16:39:01.621 | INFO     | utils.logging:log_training_results:301 - val MCE loss:1.02584 * 0.8 * 0.64536
2023-04-28 16:39:01.622 | INFO     | utils.logging:log_training_results:309 - val LLLR :0.34510 * 0.6000000000000001 * -0.40827
2023-04-28 16:39:01.622 | INFO     | utils.logging:log_training_results:317 - val weight decay:75.73897 * 0.0002 * -0.09058
2023-04-28 16:39:02.513 | INFO     | utils.logging:save_sdre_imgs:710 - Figures saved.
2023-04-28 16:39:02.851 | INFO     | utils.logging:log_training_results:280 - 
2023-04-28 16:39:02.851 | INFO     | utils.logging:log_training_results:281 - Global Step =   3750
2023-04-28 16:39:02.852 | INFO     | utils.logging:log_training_results:282 - train mean(MacRec)_t: 0.7622187733650208
2023-04-28 16:39:02.852 | INFO     | utils.logging:log_training_results:287 - train mean ABSerr: 2.1286823749542236
2023-04-28 16:39:02.852 | INFO     | utils.logging:log_training_results:290 - train ausat from confmx: 0.9040554165840149
2023-04-28 16:39:02.853 | INFO     | utils.logging:log_training_results:301 - train MCE loss:1.04499 * 0.8 * 0.64536
2023-04-28 16:39:02.853 | INFO     | utils.logging:log_training_results:309 - train LLLR :0.53982 * 0.6000000000000001 * -0.40828
2023-04-28 16:39:02.853 | INFO     | utils.logging:log_training_results:317 - train weight decay:75.73896 * 0.0002 * -0.09051
2023-04-28 16:39:21.880 | INFO     | utils.logging:investigate_log:155 - num_warning=0/num_error=0 in the .log file.
2023-04-28 16:39:22.082 | INFO     | optuna.study.study:_log_completed_trial:1020 - Trial 51 finished with value: 0.0186578631401062 and parameters: {'LIST_IS_POSITIONAL_ENCODING': True, 'LIST_IS_TRAINABLE_ENCODING': False, 'LIST_MODEL_BACKBONE': 'Transformer', 'LIST_WEIGHT_DECAY': 0.0002, 'LIST_LEARNING_RATE': 0.0003590323237284956, 'LIST_LLLR_VERSION': 'LSEL', 'LIST_ACTIVATION_FC': 'relu', 'LIST_PARAM_MULTIPLET_LOSS': 0.8, 'LIST_PARAM_LLR_LOSS': 0.6000000000000001, 'LIST_IS_ADAPTIVE_LOSS': True, 'LIST_ORDER_SPRT': 1, 'LIST_OPTIMIZER': 'adam', 'LIST_IS_NORMALIZE': False, 'LIST_NUM_THRESH': 1500, 'LIST_SPARSITY': 'unirandom', 'LIST_NUM_BLOCKS': 1, 'LIST_NUM_HEADS': 4, 'LIST_DROPOUT': 0.30000000000000004, 'LIST_FF_DIM': 32, 'LIST_MLP_UNITS': 32}. Best is trial 37 with value: 0.016635537147521973.
2023-04-28 16:39:22.103 | INFO     | utils.hyperparameter_tuning:suggest_parameters:560 - [33mStarting a tuning phase.[0m
2023-04-28 16:39:22.648 | INFO     | utils.hyperparameter_tuning:print:394 - 
+------------------------------------------+
|   Hyperparameteres suggested by Optuna   |
+------------------------+-----------------+
|     Parameter name     | Suggested value |
+------------------------+-----------------+
|     ACTIVATION_FC      |     B2Bcbrt     |
|        DROPOUT         |       0.3       |
|         FF_DIM         |        32       |
|    IS_ADAPTIVE_LOSS    |       True      |
|      IS_NORMALIZE      |      False      |
| IS_POSITIONAL_ENCODING |       True      |
| IS_TRAINABLE_ENCODING  |      False      |
|     LEARNING_RATE      |    0.00026194   |
|      LLLR_VERSION      |       LSEL      |
|       MLP_UNITS        |        32       |
|     MODEL_BACKBONE     |   Transformer   |
|       NUM_BLOCKS       |        1        |
|       NUM_HEADS        |        4        |
|       NUM_THRESH       |       1500      |
|       OPTIMIZER        |       adam      |
|       ORDER_SPRT       |        1        |
|     PARAM_LLR_LOSS     |       0.5       |
|  PARAM_MULTIPLET_LOSS  |       1.0       |
|        SPARSITY        |    unirandom    |
|      WEIGHT_DECAY      |      0.0002     |
+------------------------+-----------------+
2023-04-28 16:39:22.649 | INFO     | utils.misc:create_directories_and_log:291 - [33mA new log directory was created: [0m/home/afe/Dropbox/GitHub/SPRT-TANDEM-PyTorch/logs/public_offset0_5_optimausat_confmx_tuning/checkpoints/Transformer_20230428_163922648/configs
2023-04-28 16:39:22.650 | INFO     | utils.misc:create_directories_and_log:291 - [33mA new log directory was created: [0m/home/afe/Dropbox/GitHub/SPRT-TANDEM-PyTorch/logs/public_offset0_5_optimausat_confmx_tuning/TensorBoard_events/Transformer_20230428_163922648
